{"time":"0004","tplId":"QUICKPAY@cashier-pwd-check-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-pwd-check-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"script","children":[{"text":"amc.fn.spmPageCreate(\"a283.b4038\");var rpc=amc.rpcData;var getTag=amc.fn.getById;var hide=amc.fn.hide;var show=amc.fn.show;var loadingBlueGif=amc.path+\"alipay_msp_loading_blue.gif\";var successBlueNorepeatGif=amc.path+\"alipay_msp_success_blue.gif\";var rpcVIData=rpc.VIData;var successTxt=rpc.successText||\"{{pay_ok}}\";var payingText=rpc.doingText||\"{{paying}}\";var btnText=rpc.btnText||\"{{pay}}\";var showQuickMode=!!(rpc.oneDayOnePwdShow&&rpc.oneDayOnePwdTips);var quickModeTip=rpc.oneDayOnePwdTips;var quickModeChecked=!!rpc.oneDayOnePwdChecked;var PAY_SUCCESS_CODE=\"0001\";var PAY_FAILURE_CODE=\"0002\";var gifTag;var backAction=\"\";var VI_ACTION_START=\"viStart\";var VI_ACTION_PRE_START=\"viPreStart\";var VI_ACTION_RPC_RESPONSE=\"viRpcResponse\";var VI_ACTION_PAY_STATUS=\"payStatus\";var VI_ACTION_CLOSE_PAGE=\"viClosePage\";var VI_CHANNEL_MODE_FROM_TEMPLATE=\"1\";var logAction=amc.fn.logAction;var VI_LOG_ACTION_TYPE=\"VI\";var confirmAction=buildConfirmActionWithAct(rpc.confirmAct);var pwdType=null;var viPwdTip=null;function init(){try{initUI();if(amc.fn.logPageInit){amc.fn.logPageInit(true)}}catch(a){if(amc.fn.logPageInit){amc.fn.logPageInit()}}}function buildConfirmActionWithAct(b){var a={name:\"/pwd/validate\"};if(b&&b.name){a=b}a.viChannelMode=VI_CHANNEL_MODE_FROM_TEMPLATE;return a}function initNav(){var a=amc.res.close;if(rpc.backAction){backAction=rpc.backAction}else{if(rpc.bizType===\"deposit\"||rpc.payOrder){backAction=\"loc:back\";a=amc.res.arrowLeft}else{backAction=\"loc:exit\"}}var b=amc.fn.iNav(a,\"{{input_pwd}}\",null,null,onBack,null);getTag(\"body\").insertBefore(b,getTag(\"iLine\"));amc.fn.spmExposure(\"a283.b4038.c9698.d17397\")}function initUI(){initNav();if(amc.isIOS){var a={};try{a=getTag(\"viPlugin\").invoke(\"getAuthType\",{viData:rpcVIData})}catch(c){amc.fn.logError(\"VI\",\"getAuthType失败,\"+c)}var b=(a&&a.type)||\"pwd\";toggleBodyVisibility(b==\"pwd\"||b==\"spwd\")}startVIPlugin(rpcVIData);gifTag=getTag(\"pwdLoadGif\");getTag(\"loadTxt\").innerText=payingText;if(showQuickMode){show(\"quickMode\");hide(\"leftMargin\");getTag(\"quickModeTip\").innerText=quickModeTip;getTag(\"quickModeCheckbox\").checked=quickModeChecked}amc.fn.spmExposure(\"a283.b4038.c9698.d17395\")}function startVIPlugin(a){var b={action:VI_ACTION_START,data:a,callbacks:{onViAction:\"viCallback\"},config:{pwdInputBtn:btnText,pwdPlaceHolder:\"{{alipaypwd}}\",fpAlertMsg:\"{{confirm_exit}}\",fpAlertCancelBtn:\"{{confirm_btn}}\",fpAlertToPwdBtn:\"{{input_pwd_s}}\",pwdInputTip:rpc.pwdTip,loadingPayingText:payingText,loadingPaySuccessText:successTxt,shouldDismissAfterAuth:\"N\"}};sendDataToVIPlugin(b)}function sendDataToVIPlugin(a){getTag(\"viPlugin\").src=JSON.stringify(a);logAction((a&&a.action)||\"action\",VI_LOG_ACTION_TYPE)}function sendResponseDataToVI(a){var b={action:VI_ACTION_RPC_RESPONSE,data:a};sendDataToVIPlugin(b)}function showVILoadingWithPaymentResult(a){var b={action:VI_ACTION_PAY_STATUS,data:{status:a}};sendDataToVIPlugin(b)}function viCallback(c){var g={};try{g=JSON.parse(c)||{}}catch(f){amc.fn.logError(\"VI\",\"解析核身JSON失败\"+f);return}var b=g.action;var d=g.data;var a={viStatus:processVIStatus,viRpcRequest:processVIRpcRequest,viToPWD:processVIToPWD};if(b!=\"viStatus\"){logAction(b||\"actType\",VI_LOG_ACTION_TYPE)}amc.fn.isString(b)&&a[b]&&a[b](d)}function processVIStatus(b){if(!b){return}var a=b.status;logAction((b.type||\"type\")+\"-\"+(a||\"status\"),VI_LOG_ACTION_TYPE);if(a===\"start\"){pwdType=b.type;if(pwdType===\"pwd\"||pwdType===\"spwd\"){viPwdTip=b.tip;toggleBodyVisibility(true);showPwdInputAndTips();if(pwdType==\"spwd\"&&amc.isPlus){getTag(\"viPlugin\").className=\"vi-pwd-plus\"}}else{toggleBodyVisibility(false)}}else{if(a===\"abort\"){amc.fn.exit()}else{if(a===\"awaitUser\"){if(pwdType===\"pwd\"||pwdType===\"spwd\"){showPwdInputAndTips()}if((pwdType==\"fp\"||pwdType==\"faceid\")&&amc.isIOS){stopIOSLoading()}}else{if(a==\"findPwd\"&&amc.isIOS){amc.fn.setResult({ResultStatus:\"6006\"})}}}}}function stopIOSLoading(){document.submit({action:{name:\"loc:loading\"},param:{show:false}})}function processVIRpcRequest(a){if(pwdType==\"pwd\"||pwdType==\"spwd\"){beforeSendPwdPay();submitPay(a,onReceivePwdPay)}else{beforeSendBioPay();submitPay(a,onReceiveBioPay)}}function processVIToPWD(a){a=a||{};if((pwdType==\"fp\"||pwdType==\"faceid\")&&amc.isIOS){stopIOSLoading()}startVIPlugin(a)}function submitPay(a,b){if(amc.isAndroid&&pwdType==\"fp\"){confirmAction.loadtxt=undefined}else{confirmAction.loadtxt=\"\"}obj={action:confirmAction};obj.action[\"params\"]=mergeObjcts(obj.action[\"params\"],{VIData:a},rpc.params);if(rpc.biztype!=\"openservice\"&&(confirmAction.name==\"/pwd/validate\"||confirmAction.name==\"/cashier/pay\"||confirmAction.name==\"/cashier/payment\")){obj.action[\"neec\"]=\"6004\"}if(showQuickMode){obj.param=obj.param||{};obj.param[\"one_day_one_pwd_checked\"]=getTag(\"quickModeCheckbox\").checked?\"true\":\"false\"}document.asyncSubmit(obj,function(c){c=c||{};if(c.confirmAct&&c.confirmAct.name){confirmAction=buildConfirmActionWithAct(c.confirmAct)}b&&b(c);if(c.VIData){sendResponseDataToVI(c.VIData)}})}function beforeSendBioPay(){showVILoadingWithPaymentResult(\"paying\")}function beforeSendPwdPay(){hide(\"tips\");hide(\"pwdBox\");show(\"pwdLoad\");gifTag.src=loadingBlueGif}function onReceivePwdPay(a){a=a||{};if(a.pageloading===\"0\"&&gifTag.src===loadingBlueGif){hide(\"pwdLoad\")}else{if(a.pageloading===\"1\"){show(\"pwdLoad\")}}if(a.status===PAY_SUCCESS_CODE){showSuccessAnimation(a.successText)}else{if(a.status===PAY_FAILURE_CODE){onPaymentFail()}}}function onReceiveBioPay(a){a=a||{};if(a.status===PAY_SUCCESS_CODE){showVILoadingWithPaymentResult(\"success\")}else{if(a.status===PAY_FAILURE_CODE){showVILoadingWithPaymentResult(\"fail\")}}}function toggleBodyVisibility(a){if(a){getTag(\"body\").style.opacity=\"0.96\"}else{getTag(\"body\").style.opacity=\"0\"}}function mergeObjcts(){var a={};if(arguments&&arguments.length){for(var c=0;c<arguments.length;c++){var d=arguments[c];if(!amc.fn.isObject(d)){continue}for(var b in d){a[b]=d[b]}}}return a}function showSuccessAnimation(a){getTag(\"loadTxt\").innerText=a||successTxt;gifTag.src=successBlueNorepeatGif;show(\"pwdLoad\")}function onPaymentFail(){showPwdInputAndTips()}function showPwdInputAndTips(){var a=viPwdTip||rpc.pwdTip;if(a){viPwdTip=null;rpc.pwdTip=null;getTag(\"tips\").innerText=a;show(\"tips\")}else{hide(\"tips\")}gifTag.src=\"\";hide(\"pwdLoad\");show(\"pwdBox\")}function onQuickModeCheck(){getTag(\"quickModeCheckbox\").checked=!getTag(\"quickModeCheckbox\").checked}function onBack(){amc.fn.spmClick(\"a283.b4038.c9698.d17397\");amc.fn.spmPageDestroy(\"a283.b4038\");document.submit({action:{name:backAction}})}function forgetPwd(){amc.fn.spmClick(\"a283.b4038.c9698.d17395\");var b=\"\";if(rpc.logon_id){b=\"&loginId=\"+rpc.logon_id}var a=\"alipays://platformapi/startApp?appId=20000013&pwdType=phonePassword\"+b+\"&bizScene=mobilecashier_sdk_pay\";document.submit({action:{name:\"loc:openurl('\"+a+\"','0')\"}})}function onDestroy(){viPageCloseNotify()}function viPageCloseNotify(){var a={action:VI_ACTION_CLOSE_PAGE};sendDataToVIPluginPlugin(a)}function onKeyDown(){if(event.which==4){onBack()}};","tag":"text"}]},{"tag":"style","children":[{"text":".stretch-self {\n        align-self: stretch;\n    }\n\n    .flex-3 {\n        flex: 3.0;\n    }\n\n    .pd-lr {\n        padding-left: 15px;\n        padding-right: 15px;\n    }\n\n    .pd-t {\n        padding-top: 12px;\n    }\n\n    .pd-t-l {\n        padding-top: 20px;\n    }\n\n    .pd-t-s {\n        padding-top: 10px;\n    }\n\n    .margin-t {\n        margin-top: 15px;\n    }\n\n    .margin-r-xs {\n        margin-right: 5px;\n    }\n\n    .font-m {\n        font-size: 15px;\n    }\n\n    .font-xxl {\n        font-size: 18px;\n    }\n\n    .font-l-white {\n        font-size: 17px;\n        color: #000;\n    }\n\n    .amc-i-nav-m-box {\n        align-items: center;\n        justify-content: center;\n        flex: 3.0;\n    }\n\n    .vi-pwd-box {\n        margin-top: 15px;\n    }\n\n    .vi-pwd {\n        flex: 1.0;\n        height: 47px;\n        max-height: 47px;\n    }\n\n    .vi-pwd-plus {\n        flex: 1.0;\n        height: 61px;\n        max-height: 61px;\n    }","tag":"text"}]}]},{"id":"body","onload":"init()","tag":"body","children":[{"id":"iLine","tag":"div","css":"amc-1px-title-line"},{"id":"mainBody","tag":"div","children":[{},{"id":"tipsBox","tag":"div","children":[{"id":"tips","tag":"label","css":"amc-flex-1 font-m amc-ellipsis-2-line"}],"css":"amc-flex-center pd-lr pd-t"},{"id":"pwdBox","tag":"div","children":[{},{"id":"viPwdBox","tag":"div","children":[{"id":"viPlugin","tag":"embed","type":"VIPayPluginView","css":"vi-pwd"}],"css":"vi-pwd-box"},{"tag":"div","children":[{},{"id":"quickMode","tag":"div","children":[{"id":"quickModeCheckbox","tag":"input","type":"checkbox","css":"amc-checkbox margin-r-xs amc-align-self-start"},{"id":"quickModeTip","tag":"label","css":"amc-flex-1 font-m amc-ellipsis-2-line amc-align-self-start"}],"onclick":"onQuickModeCheck()","css":"amc-align-center flex-3 margin-r-xs pd-t-s amc-hidden"},{},{"id":"leftMargin","tag":"div","css":"amc-flex-1"},{},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{forget_pwd}}","tag":"text"}],"onclick":"forgetPwd()","css":"amc-text-right amc-theme-color amc-flex-1 amc-ellipsis-2-line font-m"}],"css":"pd-t-s amc-flex-1 amc-pd-l"}]}],"css":"pd-lr amc-v-box"},{},{"id":"pwdLoad","tag":"div","children":[{"tag":"div","css":"amc-flex-space-1"},{"id":"pwdLoadGif","tag":"embed","type":"MQPPayGifView","css":"amc-load-img"},{"tag":"div","children":[{"id":"loadTxt","tag":"label","children":[{"text":"{{paying}}","tag":"text"}],"css":"font-l-white amc-flex-1 amc-text-center amc-ellipsis-2-line"}],"css":"pd-t-l stretch-self pd-lr"},{"tag":"div","css":"amc-flex-space-2"}],"css":"amc-loading-box"}],"css":"amc-v-box amc-flex-1"}],"onkeydown":"onKeyDown()","css":"amc-i-body"}]},"format":"JSON","tplVersion":"5.2.9"}