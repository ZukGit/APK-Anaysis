{"time":"0040","tplId":"WealthCalc@financialTool_loan","publishVersion":"150603","tag":"WealthCalc","name":"financialTool_loan","data":{"tag":"html","children":[{"tag":"head","children":[{"content":"text/html; charset=UTF-8","tag":"meta","http-equiv":"Content-Type"},{"tag":"meta","src":"WealthCalc.bundle/financial.i18n","type":"i18n"},{"tag":"meta","src":"android-phone-wallet-wealthcalc/financial.i18n","type":"i18n"},{"content":"spmId:a213.b2239;bizType:fmtool;","tag":"meta","type":"bizData"},{"tag":"style","children":[{"text":"div {\n            display: flex;\n            flex-direction: row;\n            position: relative;\n        }\n\n        .cell_left_label {\n            font-size: 14px;\n            color: #000000;\n        }\n\n        .cell_right_label {\n            font-size: 14px;\n            color: #666666;\n        }\n\n        .img_style {\n            height: 13px;\n            width: 9px;\n        }","tag":"text"}]},{"tag":"script","children":[{"text":"var isShowDetail = false;\n\n        var rate_data;\n\n        var itemIndex = 0;\n        var arrItem = new Array();\n        var arrLabelItem = new Array();\n\n        var arrType = new Array();\n\n        var arrYear_text = new Array();\n        var arrYear = new Array();\n\n        var arrRate_a = new Array();\n        var arrRateMul_a = new Array();\n        var arrRateMul_text_a = new Array();\n\n        var arrRate_b = new Array();\n        var arrRateMul_b = new Array();\n        var arrRateMul_text_b = new Array();\n\n        var index_type = 0;\n        var index_type_last = 0;\n\n        var index_year = 0;\n\n        var index_rate_a = 0;\n        var index_rate_b = 0;\n\n        var old_total_money_a = \"\";\n        var total_money_a = 0;\n\n        var old_total_money_b = \"\";\n        var total_money_b = 0;\n\n        var is_loaded = false;\n\n        var arrTitleBar = new Array();\n        arrTitleBar.push(\"{{等额本息还款详情}}\");\n        arrTitleBar.push(\"{{等额本金还款详情}}\");\n\n        arrType.push(\"{{商业贷款}}\");\n        arrType.push(\"{{公积金贷款}}\");\n        arrType.push(\"{{组合贷款}}\");\n\n        var WealthCalc_bundle = \"WealthCalc.bundle/\";\n        var UICommon_bundle = \"APCommonUI.bundle/\";\n        if (document.platform == \"android\") {\n            WealthCalc_bundle = \"android-phone-wallet-wealthcalc/com.alipay.mobile.wealthtools.app/\";\n            UICommon_bundle = \"android-phone-wallet-wealthcalc/com.alipay.mobile.wealthtools.app/\";\n        }\n\n        var openPage_bundle_value = \"WealthCalc\";\n        if (document.platform == \"android\") {\n            openPage_bundle_value = \"android-phone-wallet-wealthcalc\";\n        }\n\n\n        function getPayMethod()\n        {\n            return itemIndex;\n        }\n        \n        function changeItem(index) {\n\n            arrItem[index].style.backgroundColor = \"#ffffff\";\n            arrItem[1 - index].style.backgroundColor = \"#108ee9\";\n\n            arrLabelItem[index].style.color = \"#108ee9\";\n            arrLabelItem[1 - index].style.color = \"#ffffff\";\n\n            if (index == 0) {\n                document.getElementById(\"label_dijian_title\").style.display = \"none\";\n                document.getElementById(\"label_dijian\").style.display = \"none\";\n            } else {\n                document.getElementById(\"label_dijian_title\").style.display = \"flex\";\n                document.getElementById(\"label_dijian\").style.display = \"flex\";\n            }\n\n            document.getElementById(\"label_title_bar\").innerText = arrTitleBar[index];\n\n            total_calc();\n        }\n\n        function init_ui(data, noReset) {\n            if(!noReset) {\n                arrYear_text = new Array();\n                arrYear = new Array();\n                arrRate_a = new Array();\n                arrRateMul_text_a = new Array();\n                arrRateMul_a = new Array();\n                arrRate_b = new Array();\n                arrRateMul_text_b = new Array();\n                arrRateMul_b = new Array();\n            }\n            is_loaded = true;\n\n            rate_data = JSON.stringify(data);\n            //format en\n            var lanLabel = document.createElement(\"label\");\n            lanLabel.innerText = \"{{年}}\";\n            if (lanLabel.innerText == \"Year\") {\n                document.getElementById(\"buttom_label\").innerText = \"This is the latest Loan Rate released by PBOC on \" + data.extInfo.rateUpdateTime;\n            } else {\n                document.getElementById(\"buttom_label\").innerText = \"{{以上为央行}}\" + data.extInfo.rateUpdateTime + \"{{最新公布的贷款基准利率}}\";\n            }\n\n            var businessLoanRateList = data[\"businessLoanRateList\"];\n\n            for (var i = 0; i < businessLoanRateList.length; i++) {\n                arrYear_text.push(businessLoanRateList[i][\"periodName\"].toString());\n                arrYear.push(businessLoanRateList[i][\"period\"]);\n                arrRate_a.push(parseFloat(businessLoanRateList[i][\"rate\"]));\n            }\n\n            changeItem(itemIndex);\n\n            var discountBusinessLoanRateList = data[\"discountBusinessLoanRateList\"];\n            for (var i = 0; i < discountBusinessLoanRateList.length; i++) {\n                arrRateMul_text_a.push(discountBusinessLoanRateList[i][\"rateName\"]);\n                arrRateMul_a.push(parseFloat(discountBusinessLoanRateList[i][\"rate\"]));\n            }\n\n            var providentFundLoanRateList = data[\"providentFundLoanRateList\"];\n            for (var i = 0; i < providentFundLoanRateList.length; i++) {\n                //arrYear_text.push(providentFundLoanRateList[i][\"periodName\"].toString());\n                //arrYear.push(providentFundLoanRateList[i][\"period\"]);\n                arrRate_b.push(parseFloat(providentFundLoanRateList[i][\"rate\"]));\n            }\n\n            var discountProvidentFundLoanRateList = data[\"discountProvidentFundLoanRateList\"];\n            for (var i = 0; i < discountProvidentFundLoanRateList.length; i++) {\n                arrRateMul_text_b.push(discountProvidentFundLoanRateList[i][\"rateName\"]);\n                arrRateMul_b.push(parseFloat(discountProvidentFundLoanRateList[i][\"rate\"]));\n            }\n\n            setup_type();\n            setup_day();\n            setup_rate_a();\n            setup_rate_b();\n            if (document.platform != \"android\") {\n                document.getElementById(\"J-option-menu\").style.fontSize = \"12px\";\n                document.getElementById(\"J-option-menu\").style.marginTop = \"4px\";\n            }\n        }\n\n        function initDefaultUI() {\n            arrItem.push(document.getElementById(\"item_a\"));\n            arrItem.push(document.getElementById(\"item_b\"));\n\n            arrLabelItem.push(document.getElementById(\"label_a\"));\n            arrLabelItem.push(document.getElementById(\"label_b\"));\n\n            //### 图片做跨平台处理\n            var arrayImg = document.querySelectorAll(\".img_style\");\n            for (var i = 0; i < arrayImg.length; i++) {\n                if (document.platform == \"android\") {\n                    arrayImg[i].src = UICommon_bundle + \"tables_arrow\";\n                } else {\n                    arrayImg[i].src = UICommon_bundle + \"Tables_Arrow\";\n                }\n            }\n        }\n\n        function init() {\n            initDefaultUI();\n            var defaultRpcResult = '{\"businessLoanRateList\":[{\"period\":\"60\",\"periodName\":\"5\",\"rate\":\"4.75\",\"rateName\":\"5\"},{\"period\":\"120\",\"periodName\":\"10\",\"rate\":\"4.90\",\"rateName\":\"10\"},{\"period\":\"180\",\"periodName\":\"15\",\"rate\":\"4.90\",\"rateName\":\"15\"},{\"period\":\"240\",\"periodName\":\"20\",\"rate\":\"4.90\",\"rateName\":\"20\"},{\"period\":\"300\",\"periodName\":\"25\",\"rate\":\"4.90\",\"rateName\":\"25\"},{\"period\":\"360\",\"periodName\":\"30\",\"rate\":\"4.90\",\"rateName\":\"30\"}],\"discountBusinessLoanRateList\":[{\"period\":\"\",\"periodName\":\"\",\"rate\":\"1\",\"rateName\":\"基准利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"0.7\",\"rateName\":\"7折利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"0.8\",\"rateName\":\"8折利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"0.83\",\"rateName\":\"8.3折利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"0.85\",\"rateName\":\"8.5折利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"0.88\",\"rateName\":\"8.8折利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"0.9\",\"rateName\":\"9折利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"0.95\",\"rateName\":\"9.5折利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"1.05\",\"rateName\":\"1.05倍利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"1.1\",\"rateName\":\"1.1倍利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"1.2\",\"rateName\":\"1.2倍利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"1.3\",\"rateName\":\"1.3倍利率\"}],\"discountProvidentFundLoanRateList\":[{\"period\":\"\",\"periodName\":\"\",\"rate\":\"1\",\"rateName\":\"基准利率\"},{\"period\":\"\",\"periodName\":\"\",\"rate\":\"1.1\",\"rateName\":\"1.1倍利率\"}],\"extInfo\":{\"rateUpdateTime\":\"2015年\"},\"loanRateList\":[{\"c1\":\"贷款期限\",\"c2\":\"商业贷款利率(%)\",\"c3\":\"公积金贷款利率(%)\"},{\"c1\":\"5年以上\",\"c2\":\"4.90\",\"c3\":\"3.25\"},{\"c1\":\"3-5年(含)\",\"c2\":\"4.75\",\"c3\":\"2.75\"},{\"c1\":\"1-3年(含)\",\"c2\":\"4.75\",\"c3\":\"2.75\"},{\"c1\":\"1年\",\"c2\":\"4.35\",\"c3\":\"2.75\"},{\"c1\":\"6个月\",\"c2\":\"4.35\",\"c3\":\"2.75\"}],\"providentFundLoanRateList\":[{\"period\":\"60\",\"periodName\":\"5\",\"rate\":\"2.75\",\"rateName\":\"5\"},{\"period\":\"120\",\"periodName\":\"10\",\"rate\":\"3.25\",\"rateName\":\"10\"},{\"period\":\"180\",\"periodName\":\"15\",\"rate\":\"3.25\",\"rateName\":\"15\"},{\"period\":\"240\",\"periodName\":\"20\",\"rate\":\"3.25\",\"rateName\":\"20\"},{\"period\":\"300\",\"periodName\":\"25\",\"rate\":\"3.25\",\"rateName\":\"25\"},{\"period\":\"360\",\"periodName\":\"30\",\"rate\":\"3.25\",\"rateName\":\"30\"}],\"resultCode\":\"100\",\"resultDesc\":\"处理成功\",\"resultView\":\"处理成功\",\"showType\":0,\"success\":true}';\n            init_ui(JSON.parse(defaultRpcResult), true);\n            document.invoke(\"rpc\", {\n                    \"operationType\": \"alipay.mwealth.toolkit.interest.queryLoanRate\",\n                    \"requestData\": [{}]\n                },\n                function (rsp) {\n\n                    if (rsp.success) {\n\n                        var bizResult = rsp.result;\n                        if (bizResult.success) {\n\n                            init_ui(bizResult, false);\n\n                            document.setProp(\"userPreferences\", {\n                                \"key\": \"WealthCalc_yuedongweng_loan\",\n                                \"business\": \"WealthCalc\",\n                                \"data\": bizResult\n                            });\n                        } else {\n\n                            var bizResult = document.getProp(\"userPreferences\", {\n                                \"key\": \"WealthCalc_yuedongweng_loan\",\n                                \"business\": \"WealthCalc\"\n                            });\n\n                            init_ui(JSON.parse(bizResult), false);\n                        }\n                    } else {\n\n                        var bizResult = document.getProp(\"userPreferences\", {\n                            \"key\": \"WealthCalc_yuedongweng_loan\",\n                            \"business\": \"WealthCalc\"\n                        });\n\n                        init_ui(JSON.parse(bizResult), false);\n                    }\n                }\n            );\n\n        }\n\n        function fmoney(s) {\n            var l = s.split(\".\")[0].split(\"\").reverse();\n\n            r = s.split(\".\")[1];\n            t = \"\";\n\n            for (i = 0; i < l.length; i++) {\n                t += l[i] + ((i + 1) % 3 == 0 && (i + 1) != l.length ? \",\" : \"\");\n            }\n\n            var ret = t.split(\"\").reverse().join(\"\");\n            if (r != undefined) {\n                ret = ret + \".\" + r;\n            }\n\n            return ret;\n        }\n\n        function calc_total(month, rate, money) {\n\n            rate = rate / 100 / 12;\n            var temp = Math.pow(1 + rate, month);\n            return (money * 10000 * rate * temp) / (temp - 1);\n        }\n\n        function total_calc() {\n\n            if (is_loaded == false)\n                return;\n\n            //### 纯商贷\n            if (index_type == 0) {\n\n                //### 等额本息\n                if (itemIndex == 0) {\n                    var result = calc_total(arrYear[index_year], arrRate_a[index_year] * arrRateMul_a[index_rate_a], total_money_a);\n                    document.getElementById(\"label_yuegong\").innerText = fmoney(result.toFixed(2));\n\n                    document.getElementById(\"lixi\").innerText = fmoney((result * arrYear[index_year] - total_money_a * 10000).toFixed(2));\n                    document.getElementById(\"zonge\").innerText = fmoney((result * arrYear[index_year]).toFixed(2));\n                }\n                //### 等额本金\n                else {\n                    var rate = arrRate_a[index_year] * arrRateMul_a[index_rate_a] / 100 / 12;\n                    var benjin = total_money_a * 10000 / arrYear[index_year];\n                    var dijian = benjin * rate;\n                    var lixi = total_money_a * 10000 * rate;\n\n                    document.getElementById(\"label_yuegong\").innerText = fmoney((benjin + lixi).toFixed(2));\n                    document.getElementById(\"label_dijian\").innerText = fmoney((dijian).toFixed(2));\n\n                    var totol_lixi = 0;\n                    var totol_benjin = total_money_a * 10000;\n                    for (var i = 0; i < arrYear[index_year]; i++) {\n                        totol_lixi = totol_lixi + totol_benjin * rate;\n                        totol_benjin = totol_benjin - benjin;\n                    }\n\n                    document.getElementById(\"lixi\").innerText = fmoney((totol_lixi).toFixed(2));\n                    document.getElementById(\"zonge\").innerText = fmoney((totol_lixi + total_money_a * 10000).toFixed(2));\n                }\n\n                if (total_money_a > 0) {\n                    document.getElementById(\"label_title_bar\").innerText = arrTitleBar[itemIndex] + \" >\";\n                    document.getElementById(\"label_title_bar\").style.color = \"#108ee9\";\n                    isShowDetail = true;\n                } else {\n                    document.getElementById(\"label_title_bar\").innerText = arrTitleBar[itemIndex];\n                    document.getElementById(\"label_title_bar\").style.color = \"#6f6f6f\";\n                    isShowDetail = false;\n                }\n            }\n\n            //### 纯公积金贷\n            else if (index_type == 1) {\n\n                //### 等额本息\n                if (itemIndex == 0) {\n                    var result = calc_total(arrYear[index_year], arrRate_b[index_year] * arrRateMul_b[index_rate_b], total_money_b);\n                    document.getElementById(\"label_yuegong\").innerText = fmoney(result.toFixed(2));\n\n                    document.getElementById(\"lixi\").innerText = fmoney((result * arrYear[index_year] - total_money_b * 10000).toFixed(2));\n                    document.getElementById(\"zonge\").innerText = fmoney((result * arrYear[index_year]).toFixed(2));\n                }\n                //### 等额本金\n                else {\n                    var rate = arrRate_b[index_year] * arrRateMul_b[index_rate_b] / 100 / 12;\n                    var benjin = total_money_b * 10000 / arrYear[index_year];\n                    var dijian = benjin * rate;\n                    var lixi = total_money_b * 10000 * rate;\n\n                    document.getElementById(\"label_yuegong\").innerText = fmoney((benjin + lixi).toFixed(2));\n                    document.getElementById(\"label_dijian\").innerText = fmoney((dijian).toFixed(2));\n\n                    var totol_lixi = 0;\n                    var totol_benjin = total_money_b * 10000;\n                    for (var i = 0; i < arrYear[index_year]; i++) {\n                        totol_lixi = totol_lixi + totol_benjin * rate;\n                        totol_benjin = totol_benjin - benjin;\n                    }\n\n                    document.getElementById(\"lixi\").innerText = fmoney((totol_lixi).toFixed(2));\n                    document.getElementById(\"zonge\").innerText = fmoney((totol_lixi + total_money_b * 10000).toFixed(2));\n                }\n\n                if (total_money_b > 0) {\n                    document.getElementById(\"label_title_bar\").innerText = arrTitleBar[itemIndex] + \" >\";\n                    document.getElementById(\"label_title_bar\").style.color = \"#108ee9\";\n                    isShowDetail = true;\n                } else {\n                    document.getElementById(\"label_title_bar\").innerText = arrTitleBar[itemIndex];\n                    document.getElementById(\"label_title_bar\").style.color = \"#6f6f6f\";\n                    isShowDetail = false;\n                }\n            }\n\n            //### 组合贷款\n            else {\n\n                //### 等额本息\n                if (itemIndex == 0) {\n                    var result_a = calc_total(arrYear[index_year], arrRate_a[index_year] * arrRateMul_a[index_rate_a], total_money_a);\n\n                    var result_b = calc_total(arrYear[index_year], arrRate_b[index_year] * arrRateMul_b[index_rate_b], total_money_b);\n\n                    var result = result_a + result_b;\n\n                    document.getElementById(\"label_yuegong\").innerText = fmoney(result.toFixed(2));\n\n                    document.getElementById(\"lixi\").innerText = fmoney((result * arrYear[index_year] - total_money_a * 10000 - total_money_b * 10000).toFixed(2));\n                    document.getElementById(\"zonge\").innerText = fmoney((result * arrYear[index_year]).toFixed(2));\n                }\n                //### 等额本金\n                else {\n                    var rate_b = arrRate_b[index_year] * arrRateMul_b[index_rate_b] / 100 / 12;\n                    var benjin_b = total_money_b * 10000 / arrYear[index_year];\n                    var dijian_b = benjin_b * rate_b;\n                    var lixi_b = total_money_b * 10000 * rate_b;\n\n                    var totol_lixi_b = 0;\n                    var totol_benjin_b = total_money_b * 10000;\n                    for (var i = 0; i < arrYear[index_year]; i++) {\n                        totol_lixi_b = totol_lixi_b + totol_benjin_b * rate_b;\n                        totol_benjin_b = totol_benjin_b - benjin_b;\n                    }\n\n                    var rate_a = arrRate_a[index_year] * arrRateMul_a[index_rate_a] / 100 / 12;\n                    var benjin_a = total_money_a * 10000 / arrYear[index_year];\n                    var dijian_a = benjin_a * rate_a;\n                    var lixi_a = total_money_a * 10000 * rate_a;\n\n                    var totol_lixi_a = 0;\n                    var totol_benjin_a = total_money_a * 10000;\n                    for (var i = 0; i < arrYear[index_year]; i++) {\n                        totol_lixi_a = totol_lixi_a + totol_benjin_a * rate_a;\n                        totol_benjin_a = totol_benjin_a - benjin_a;\n                    }\n\n                    document.getElementById(\"label_yuegong\").innerText = fmoney((benjin_a + lixi_a + benjin_b + lixi_b).toFixed(2));\n                    document.getElementById(\"label_dijian\").innerText = fmoney((dijian_a + dijian_b).toFixed(2));\n\n                    document.getElementById(\"lixi\").innerText = fmoney((totol_lixi_a + totol_lixi_b).toFixed(2));\n                    document.getElementById(\"zonge\").innerText = fmoney((totol_lixi_a + total_money_a * 10000 + totol_lixi_b + total_money_b * 10000).toFixed(2));\n                }\n\n                if (total_money_a > 0 || total_money_b > 0) {\n                    document.getElementById(\"label_title_bar\").innerText = arrTitleBar[itemIndex] + \" >\";\n                    document.getElementById(\"label_title_bar\").style.color = \"#108ee9\";\n\n                    isShowDetail = true;\n                } else {\n                    document.getElementById(\"label_title_bar\").innerText = arrTitleBar[itemIndex];\n                    document.getElementById(\"label_title_bar\").style.color = \"#6f6f6f\";\n\n                    isShowDetail = false;\n                }\n            }\n        }\n\n        function showDetail() {\n\n            if (is_loaded == false)\n                return;\n\n            if (isShowDetail) {\n                print(\"total_money_a is \" + total_money_a + \", total_money_b \" + total_money_b);\n                var initData = {\n                    \"businessLoan\": total_money_a,\n                    \"providentFundLoan\": total_money_b,\n                    \"month\": arrYear[index_year],\n                    \"businessLoanRate\": arrRate_a[index_year] * arrRateMul_a[index_rate_a],\n                    \"providentFundLoanRate\": arrRate_b[index_year] * arrRateMul_b[index_rate_b],\n                    \"type\": itemIndex\n                }\n                \n                document.invoke(\"log\", {\n                            \"actionId\": \"clicked\",\n                            \"extParams\": {\"LoanAmt\":document.getElementById(\"input_money_b\").value,\"PayMethod\":getPayMethod()},\n                            \"appId\": \"20000161\",\n                            \"seed\": \"a213.b2239.c4968.d7808\",\n                            \"bizType\": \"fmtool\",\n                        }, function(rsp) {\n                        });\n                        \n                if (document.platform != \"android\") {\n                    document.invoke('openPage', {\n                        \"tplId\": \"WealthCalc@financialTool_loan_detail\",\n                        \"defaultTitle\": \"{{还款详情}}\",\n                        \"bundle\": openPage_bundle_value,\n                        \"initData\": JSON.stringify(initData)\n                    });\n                } else {\n                    document.invoke('openPage', {\n                        \"tplId\": \"WealthCalc@financialTool_loan_detail\",\n                        \"defaultTitle\": \"{{还款详情}}\",\n                        \"bundle_a\": openPage_bundle_value,\n                        \"initData\": JSON.stringify(initData)\n                    });\n                }\n            }\n        }\n        \n        var money_a_value = \"\";\n        function input_money_a() {\n\n            var input = document.getElementById(\"input_money_a\").value;\n\n            input = input.replace(/,/g, '');\n            \n            \n            // 贷款金额键盘删除埋点\n            if ((money_a_value.length - input.length) == 1) {\n                document.invoke(\"log\", {\n                    \"actionId\": \"clicked\",\n                    \"extParams\": {\"LoanAmt\":input,\"PayMethod\":getPayMethod()},\n                    \"appId\": \"20000161\",\n                    \"seed\": \"a213.b2239.c4972.d7813\",\n                    \"bizType\": \"fmtool\",\n                }, function(rsp) {\n                });\n            }\n            money_a_value = input;\n\n            if (input == \".\") input = \"0.\";\n\n            if (input == \"\") {\n                old_total_money_a = \"\";\n            }\n\n            var reg = \"^(([1-9]{1}\\\\d{0,3})|([0]{1}))(\\\\.(\\\\d){0,2})?$\";\n            var r = input.match(reg);\n            if (r == null) {\n\n                document.getElementById(\"input_money_a\").value = fmoney(old_total_money_a);\n            } else {\n\n                old_total_money_a = input;\n                document.getElementById(\"input_money_a\").value = fmoney(input);\n            }\n\n            if (old_total_money_a == \"\") total_money_a = 0;\n            else total_money_a = parseFloat(old_total_money_a);\n\n            total_calc();\n        }\n        \n        var money_b_value = \"\";\n        function input_money_b() {\n\n            var input = document.getElementById(\"input_money_b\").value;\n\n            input = input.replace(/,/g, '');\n\n            // 贷款金额键盘删除埋点\n            if ((money_b_value.length - input.length) == 1) {\n                document.invoke(\"log\", {\n                    \"actionId\": \"clicked\",\n                    \"extParams\": {\"LoanAmt\":input,\"PayMethod\":getPayMethod()},\n                    \"appId\": \"20000161\",\n                    \"seed\": \"a213.b2239.c4972.d7813\",\n                    \"bizType\": \"fmtool\",\n                }, function(rsp) {\n                });\n            }\n            money_b_value = input;\n\n\n            if (input == \".\") input = \"0.\";\n\n            if (input == \"\") {\n                old_total_money_b = \"\";\n            }\n\n            var reg = \"^(([1-9]{1}\\\\d{0,3})|([0]{1}))(\\\\.(\\\\d){0,2})?$\";\n            var r = input.match(reg);\n            if (r == null) {\n\n                document.getElementById(\"input_money_b\").value = fmoney(old_total_money_b);\n            } else {\n\n                old_total_money_b = input;\n                document.getElementById(\"input_money_b\").value = fmoney(input);\n            }\n\n            if (old_total_money_b == \"\") total_money_b = 0;\n            else total_money_b = parseFloat(old_total_money_b);\n\n            total_calc();\n        }\n        \n        function input_money_a_blur()\n        {\n            // 键盘隐藏埋点\n            document.invoke(\"log\", {\n                    \"actionId\": \"clicked\",\n                    \"extParams\": {\"LoanAmt\":document.getElementById(\"input_money_a\").value,\"PayMethod\":getPayMethod()},\n                    \"appId\": \"20000161\",\n                    \"seed\": \"a213.b2239.c4972.d7815\",\n                    \"bizType\": \"fmtool\",\n                }, function(rsp) {\n                });\n        }\n        function input_money_b_blur()\n        {\n            // 键盘隐藏埋点\n            document.invoke(\"log\", {\n                    \"actionId\": \"clicked\",\n                    \"extParams\": {\"LoanAmt\":document.getElementById(\"input_money_b\").value,\"PayMethod\":getPayMethod()},\n                    \"appId\": \"20000161\",\n                    \"seed\": \"a213.b2239.c4972.d7815\",\n                    \"bizType\": \"fmtool\",\n                }, function(rsp) {\n                });\n        }\n\n\n        function select_type() {\n\n            if (is_loaded == false)\n                return;\n\n            var obj = {\n                'btns': arrType,\n                'default': index_type,\n                'title': ''\n            };\n\n            document.picker(obj,\n                function (data) {\n\n                    document.invoke(\"log\", {\n                        \"actionId\": \"clicked\",\n                        \"extParams\": {\"LoanType\":data.index,\"PayMethod\":getPayMethod()},\n                        \"appId\": \"20000161\",\n                        \"seed\": \"a213.b2239.c4971.d7812\",\n                        \"bizType\": \"fmtool\",\n                    }, function(rsp) {\n                    });\n\n                    index_type_last = index_type;\n                    index_type = data.index;\n\n                    setup_type();\n                    total_calc();\n                });\n        }\n\n        function select_day() {\n\n            if (is_loaded == false)\n                return;\n\n            var obj = {\n                'btns': arrYear_text,\n                'default': index_year,\n                'title': ''\n            };\n\n            document.picker(obj,\n                function (data) {\n\n                    document.invoke(\"log\", {\n                        \"actionId\": \"clicked\",\n                        \"extParams\": {\"LoanTerm\":data.index},\n                        \"appId\": \"20000161\",\n                        \"seed\": \"a213.b2239.c4974.d7817\",\n                        \"bizType\": \"fmtool\",\n                    }, function(rsp) {\n                    });\n\n                    index_year = data.index;\n\n                    setup_day();\n                    setup_rate_a();\n                    setup_rate_b();\n                });\n        }\n\n        function select_rate_a() {\n\n            if (is_loaded == false)\n                return;\n\n            var obj = {\n                'btns': arrRateMul_text_a,\n                'default': index_rate_a,\n                'title': ''\n            };\n\n            document.picker(obj,\n                function (data) {\n\n                    document.invoke(\"log\", {\n                        \"actionId\": \"clicked\",\n                        \"extParams\": {\"LoanRate\":data.index},\n                        \"appId\": \"20000161\",\n                        \"seed\": \"a213.b2239.c4975.d7819\",\n                        \"bizType\": \"fmtool\",\n                    }, function(rsp) {\n                    });\n                    \n                    index_rate_a = data.index;\n\n                    setup_rate_a();\n                });\n        }\n\n        function select_rate_b() {\n\n            if (is_loaded == false)\n                return;\n\n            var obj = {\n                'btns': arrRateMul_text_b,\n                'default': index_rate_b,\n                'title': ''\n            };\n\n            document.picker(obj,\n                function (data) {\n\n                    document.invoke(\"log\", {\n                        \"actionId\": \"clicked\",\n                        \"extParams\": {\"LoanRate\":data.index},\n                        \"appId\": \"20000161\",\n                        \"seed\": \"a213.b2239.c4975.d7819\",\n                        \"bizType\": \"fmtool\",\n                    }, function(rsp) {\n                    });\n\n                    index_rate_b = data.index;\n\n                    setup_rate_b();\n                });\n        }\n\n        function setup_type() {\n\n            if (is_loaded == false)\n                return;\n\n            document.getElementById(\"input_money_a\").value = \"\";\n            document.getElementById(\"input_money_b\").value = \"\";\n\n            input_money_a();\n            input_money_b();\n\n            document.getElementById(\"label_type\").innerText = arrType[index_type];\n\n            if (index_type == 0) {\n                document.getElementById(\"div_rate_a\").style.display = \"flex\";\n                document.getElementById(\"div_rate_b\").style.display = \"none\";\n\n                document.getElementById(\"div_money_a\").style.display = \"flex\";\n                document.getElementById(\"div_money_b\").style.display = \"none\";\n\n                document.getElementById(\"label_money_a\").innerText = \"{{贷款金额(万)}}\";\n\n                document.getElementById(\"label_rate_title_a\").innerText = \"{{利率(%)}}\";\n                document.getElementById(\"label_rate_title_b\").innerText = \"{{利率(%)}}\";\n            } else if (index_type == 1) {\n                document.getElementById(\"div_rate_a\").style.display = \"none\";\n                document.getElementById(\"div_rate_b\").style.display = \"flex\";\n\n                document.getElementById(\"div_money_a\").style.display = \"none\";\n                document.getElementById(\"div_money_b\").style.display = \"flex\";\n\n                document.getElementById(\"label_money_b\").innerText = \"{{贷款金额(万)}}\";\n\n                document.getElementById(\"label_rate_title_a\").innerText = \"{{利率(%)}}\";\n                document.getElementById(\"label_rate_title_b\").innerText = \"{{利率(%)}}\";\n            } else {\n                document.getElementById(\"div_rate_a\").style.display = \"flex\";\n                document.getElementById(\"div_rate_b\").style.display = \"flex\";\n\n                document.getElementById(\"div_money_a\").style.display = \"flex\";\n                document.getElementById(\"div_money_b\").style.display = \"flex\";\n\n                document.getElementById(\"label_money_a\").innerText = \"{{商贷金额(万)}}\";\n                document.getElementById(\"label_money_b\").innerText = \"{{公积金贷款金额(万)}}\";\n\n                document.getElementById(\"label_rate_title_a\").innerText = \"{{商贷利率(%)}}\";\n                document.getElementById(\"label_rate_title_b\").innerText = \"{{公积金贷利率(%)}}\";\n            }\n        }\n\n        function setup_day() {\n\n            if (is_loaded == false)\n                return;\n\n            document.getElementById(\"label_day\").innerText = arrYear_text[index_year];\n        }\n\n        function setup_rate_a() {\n\n            if (is_loaded == false)\n                return;\n            document.getElementById(\"label_rate_a\").innerText = (arrRate_a[index_year] * arrRateMul_a[index_rate_a]).toFixed(2);\n            total_calc();\n        }\n\n        function setup_rate_b() {\n\n            if (is_loaded == false)\n                return;\n\n            document.getElementById(\"label_rate_b\").innerText = (arrRate_b[index_year] * arrRateMul_b[index_rate_b]).toFixed(2);\n            total_calc();\n        }\n\n        function item_click() {\n\n            itemIndex = 1 - itemIndex;\n            \n            // 等额本息\n            if (itemIndex == 0) {\n                document.invoke(\"log\", {\n                    \"actionId\": \"clicked\",\n                    \"extParams\": {},\n                    \"appId\": \"20000161\",\n                    \"seed\": \"a213.b2239.c4967.d7806\",\n                    \"bizType\": \"fmtool\",\n                }, function(rsp) {\n                });\n            }\n            // 等额本金\n            if (itemIndex == 1) {\n                document.invoke(\"log\", {\n                    \"actionId\": \"clicked\",\n                    \"extParams\": {},\n                    \"appId\": \"20000161\",\n                    \"seed\": \"a213.b2239.c4967.d7807\",\n                    \"bizType\": \"fmtool\",\n                }, function(rsp) {\n                });\n            }\n\n            changeItem(itemIndex);\n        }\n\n        function onDespoist_rate() {\n\n            if (is_loaded == false)\n                return;\n            \n            var PayMethod = getPayMethod();\n            document.invoke(\"log\", {\n                    \"actionId\": \"clicked\",\n                    \"extParams\": {\"PayMethod\":PayMethod},\n                    \"appId\": \"20000161\",\n                    \"seed\": \"a213.b2239.c4966.d7805\",\n                    \"bizType\": \"fmtool\",\n                }, function(rsp) {\n                });\n\n\n            if (document.platform != \"android\") {\n                document.invoke('openPage', {\n                    \"tplId\": \"WealthCalc@financialTool_despoist_rate\",\n                    \"defaultTitle\": \"{{利率表}}\",\n                    \"initData\": rate_data,\n                    \"bundle\": openPage_bundle_value\n                });\n            } else {\n                document.invoke('openPage', {\n                    \"tplId\": \"WealthCalc@financialTool_despoist_rate\",\n                    \"defaultTitle\": \"{{利率表}}\",\n                    \"initData\": rate_data,\n                    \"bundle_a\": openPage_bundle_value\n                });\n            }\n        }\n\n        function keydown_a() {\n\n            if (event.which == 10) {\n                // 贷款金额键盘确定埋点\n                document.invoke(\"log\", {\n                    \"actionId\": \"clicked\",\n                    \"extParams\": {\"LoanAmt\":document.getElementById(\"input_money_a\").value,\"PayMethod\":getPayMethod()},\n                    \"appId\": \"20000161\",\n                    \"seed\": \"a213.b2239.c4972.d7814\",\n                    \"bizType\": \"fmtool\",\n                }, function(rsp) {\n                });\n\n                if (index_type == 2) {\n                    document.getElementById(\"input_money_b\").focus();\n                } else {\n                    document.getElementById(\"input_money_a\").blur();\n                }\n            }\n        }\n\n        function keydown_b() {\n\n            if (event.which == 10) {\n\n                // 贷款金额键盘确定埋点\n                document.invoke(\"log\", {\n                    \"actionId\": \"clicked\",\n                    \"extParams\": {\"LoanAmt\":document.getElementById(\"input_money_b\").value,\"PayMethod\":getPayMethod()},\n                    \"appId\": \"20000161\",\n                    \"seed\": \"a213.b2239.c4972.d7814\",\n                    \"bizType\": \"fmtool\",\n                }, function(rsp) {\n                });\n\n                document.getElementById(\"input_money_b\").blur();\n            }\n        }","tag":"text"}]}]},{"id":"bodyid","style":"flex-direction:column; height:100%; background-color:#f5f5f9;overflow:scroll;","onload":"init();","tag":"body","children":[{"tag":"nav","children":[{"tag":"div"},{"tag":"div"},{"tag":"div","children":[{"id":"J-option-menu","style":"color:#108ee9;","tag":"label","children":[{"text":"{{利率表}}","tag":"text"}],"onclick":"onDespoist_rate()"}]}]},{"style":"background-color:#108ee9; height:184px; width:100%; flex-direction:column; align-items:center;","tag":"div","children":[{"style":"width:221px; height:23px; border-radius:4px; border:1px #ffffff solid; margin-top:12px;","tag":"div","children":[{"id":"item_a","style":"border-radius:4px 4px 0px 0px 0px 0px 4px 4px;flex:1;align-items:center;justify-content:center; background-color:#ffffff;","tag":"div","children":[{"id":"label_a","style":"font-size:12px; color:#108ee9;","tag":"label","children":[{"text":"{{等额本息}}","tag":"text"}]}],"onclick":"item_click()"},{"id":"item_b","style":"border-radius:0px 0px 4px 4px 4px 4px 0px 0px;flex:1;align-items:center;justify-content:center; background-color:#108ee9;","tag":"div","children":[{"id":"label_b","style":"font-size:12px; color:#ffffff;","tag":"label","children":[{"text":"{{等额本金}}","tag":"text"}]}],"onclick":"item_click()"}]},{"style":"height:90px; width:100%; padding:10px 15px 10px 15px;","tag":"div","children":[{"style":"flex:1; flex-direction:column; justify-content:center;","tag":"div","children":[{"style":"font-size:11px; color:#ffffff;","tag":"label","children":[{"text":"{{每月月供参考(元)}}","tag":"text"}]},{"id":"label_yuegong","style":"font-size:28px; font-auto-adjust:true; color:#ffffff;  margin-top:5px; margin-right:15px; text-overflow:ellipsis; overflow:hidden; white-space:nowrap;","tag":"label","children":[{"text":"0.00","tag":"text"}]}]},{"style":"flex:1; flex-direction:column; padding-left:15px; justify-content:center;","tag":"div","children":[{"id":"label_dijian_title","style":"font-size:11px; color:#ffffff;","tag":"label","children":[{"text":"{{每月递减(元)}}","tag":"text"}]},{"id":"label_dijian","style":"font-size:28px; color:#ffffff; margin-top:5px; text-overflow:ellipsis; overflow:hidden; white-space:nowrap;","tag":"label","children":[{"text":"0.00","tag":"text"}]}]}]},{"style":"flex:1; width:100%;padding:0px 15px 10px 15px;","tag":"div","children":[{"style":"flex:1.001; flex-direction:column;","tag":"div","children":[{"style":"font-size:11px; color:#ffffff;","tag":"label","children":[{"text":"{{支付利息(元)}}","tag":"text"}]},{"id":"lixi","style":"font-size:18px; font-auto-adjust:true; color:#ffffff;  margin-top:5px; margin-right:15px; text-overflow:ellipsis; overflow:hidden; white-space:nowrap;","tag":"label","children":[{"text":"0.00","tag":"text"}]}]},{"style":"width:1PX; background-color:#4dc4f3;","tag":"div"},{"style":"flex:1; flex-direction:column; padding-left:15px;","tag":"div","children":[{"style":"font-size:11px; color:#ffffff;","tag":"label","children":[{"text":"{{还款总额(元)}}","tag":"text"}]},{"id":"zonge","style":"font-size:18px; font-auto-adjust:true; color:#ffffff; margin-top:5px; text-overflow:ellipsis; overflow:hidden; white-space:nowrap;","tag":"label","children":[{"text":"0.00","tag":"text"}]}]}]}]},{"style":"height:30px; background-color:#eaf4fa; justify-content:center; align-items:center;","tag":"div","children":[{"id":"label_title_bar","style":"font-size:12px; color:#6f6f6f;","tag":"label","children":[{"text":"{{等额本息还款详情}}","tag":"text"}]}],"onclick":"showDetail()"},{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"style":"background-color:#ffffff; flex-direction:column; padding-left:15px;","tag":"div","children":[{"style":"height:44px; padding-right:15px; align-items:center;","tag":"div","children":[{"tag":"label","children":[{"text":"{{贷款类型}}","tag":"text"}],"css":"cell_left_label"},{"style":"flex:1;","tag":"div"},{"id":"label_type","style":"margin-right:5px;","tag":"label","css":"cell_right_label"},{"tag":"img","css":"img_style"}],"onclick":"select_type()"},{"id":"div_money_a","style":"flex-direction:column;","tag":"div","children":[{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"style":"height:44px; padding-right:15px; align-items:center;","tag":"div","children":[{"id":"label_money_a","tag":"label","children":[{"text":"{{贷款金额(万)}}","tag":"text"}],"css":"cell_left_label"},{"style":"flex:1;","tag":"div"},{"id":"input_money_a","style":"width:130px; text-align:right;","placeholder":"{{请输入金额}}","tag":"input","onblur":"input_money_a_blur()","onkeydown":"keydown_a()","type":"money","css":"cell_right_label","oninput":"input_money_a()"}]}]},{"id":"div_money_b","style":"flex-direction:column;","tag":"div","children":[{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"style":"height:44px; padding-right:15px; align-items:center;","tag":"div","children":[{"id":"label_money_b","tag":"label","children":[{"text":"{{公积金贷款金额(万)}}","tag":"text"}],"css":"cell_left_label"},{"style":"flex:1;","tag":"div"},{"id":"input_money_b","style":"width:130px; text-align:right;","placeholder":"{{请输入金额}}","tag":"input","onblur":"input_money_b_blur()","onkeydown":"keydown_b()","type":"money","css":"cell_right_label","oninput":"input_money_b()"}]}]},{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"style":"height:44px; padding-right:15px; align-items:center;","tag":"div","children":[{"tag":"label","children":[{"text":"{{期限(年)}}","tag":"text"}],"css":"cell_left_label"},{"style":"flex:1;","tag":"div"},{"id":"label_day","style":"margin-right:5px;","tag":"label","css":"cell_right_label"},{"tag":"img","css":"img_style"}],"onclick":"select_day();"},{"id":"div_rate_a","style":"flex-direction:column;","tag":"div","children":[{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"style":"height:44px; align-items:center; padding-right:15px;","tag":"div","children":[{"id":"label_rate_title_a","tag":"label","children":[{"text":"{{利率(%)}}","tag":"text"}],"css":"cell_left_label"},{"style":"flex:1;","tag":"div"},{"id":"label_rate_a","style":"text-align:right; margin-right:5px;","tag":"label","css":"cell_right_label"},{"tag":"img","css":"img_style"}],"onclick":"select_rate_a()"}]},{"id":"div_rate_b","style":"flex-direction:column;","tag":"div","children":[{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"style":"height:44px; align-items:center; padding-right:15px;","tag":"div","children":[{"id":"label_rate_title_b","tag":"label","children":[{"text":"{{利率(%)}}","tag":"text"}],"css":"cell_left_label"},{"style":"flex:1;","tag":"div"},{"id":"label_rate_b","style":"text-align:right; margin-right:5px;","tag":"label","css":"cell_right_label"},{"tag":"img","css":"img_style"}],"onclick":"select_rate_b()"}]}]},{"style":"height:1PX; background-color:#e5e5e5;","tag":"div"},{"id":"buttom_label","style":"font-size:12px; color:#999999; margin-left:15px; margin-top:4px;","tag":"label"}]}]},"format":"JSON","tplVersion":"5.0.3"}