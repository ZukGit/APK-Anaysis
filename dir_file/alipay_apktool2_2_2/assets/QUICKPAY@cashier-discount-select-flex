{"time":"0002","tplId":"QUICKPAY@cashier-discount-select-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-discount-select-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"script","children":[{"text":"var getTag=amc.fn.getById;var create=amc.fn.create;var rpc=amc.rpcData;var gouPng=amc.path+\"alipay_msp_gou\";var showSubmitBtn=(rpc.scene===\"offline_tb\");var discountArray=new Array();var discountMoreArray=new Array();var discountInitIndex=\"\";var submitParam={};function init(){try{initUI();if(amc.fn.logPageInit){amc.fn.logPageInit(true)}}catch(a){if(amc.fn.logPageInit){amc.fn.logPageInit()}}}function initUI(){var b=amc.res.close;if(!showSubmitBtn){amc.fn.hide(\"submitArea\");b=amc.res.arrowLeft}var c=amc.fn.iNav(b,\"{{choose_dis}}\",null,null,onBack,null);getTag(\"body\").insertBefore(c,getTag(\"iLine\"));for(var a=0;rpc.discounts&&a<rpc.discounts.length;a++){createItem(rpc.discounts[a],a)}}function getDiscountIndex(){var b=\"\";submitParam={};for(var c=0,a=0;c<rpc.discounts.length;c++){if(rpc.discounts[c][\"checked_more\"]===undefined){if(discountArray[a].src!==\"\"){b+=\"Y\";submitParam.discount_option_value=rpc.discounts[c].value}else{b+=\"N\"}a++}else{if(discountMoreArray[c-a].checked===true||discountMoreArray[c-a].checked===\"1\"){b+=\"Y\";submitParam[rpc.discounts[c].value]=\"true\"}else{b+=\"N\";submitParam[rpc.discounts[c].value]=\"false\"}}}return b}function createItem(j,d){var i=getTag(\"discount\");var e=create(\"div\");e.className=\"amc-item amc-pd-lr amc-align-center\";var h=create(\"div\");h.className=\"amc-item\";e.appendChild(h);var f=create(\"label\");f.className=\"amc-item-m-text\";f.innerText=j.name||\"\";f.style.color=\"#000\";h.appendChild(f);if(j.checked_more!==undefined){var c;c=create(\"input\");e.appendChild(c);c.type=\"checkbox\";c.className=\"amc-checkbox\";c.checked=j.checked_more;discountMoreArray.push(c);e.onclick=function(){c.checked=!c.checked};if(c.checked===true||c.checked===\"1\"){discountInitIndex+=\"Y\"}else{discountInitIndex+=\"N\"}}else{var g=create(\"img\");var a=create(\"div\");a.appendChild(g);a.className=\"amc-check-img-box\";e.appendChild(a);discountArray.push(g);if(j.checked){g.src=gouPng;discountInitIndex+=\"Y\"}else{discountInitIndex+=\"N\";g.src=\"\"}e.onclick=function(){if(g.src!==\"\"){g.src=\"\"}else{for(var l=0;l<discountArray.length;l++){discountArray[l].src=\"\"}g.src=gouPng}}}i.appendChild(e);var k=create(\"div\");k.className=\"amc-1px-line amc-pd-lr\";var b=create(\"div\");b.className=\"amc-pd-lr amc-v-box\";b.appendChild(k);i.appendChild(b);return e}function onBack(){if(!showSubmitBtn){var a=getDiscountIndex();if(a!==discountInitIndex){onSubmit(a)}else{amc.fn.back()}}else{amc.fn.exit()}}function onSubmit(a){var c={action:{name:\"/cashier/selectDiscount\"}};c.param=submitParam;var b=a||getDiscountIndex();document.submit(c);discountInitIndex=b}function onKeyDown(){if(event.which==4){onBack()}};","tag":"text"}]},{"tag":"style"}]},{"id":"body","onload":"init()","tag":"body","children":[{"id":"iLine","tag":"div","css":"amc-1px-title-line"},{"id":"scrollBox","tag":"div","children":[{},{"id":"discount","tag":"div","css":"amc-v-box"}],"css":"amc-scroll-flex"},{"id":"submitArea","tag":"div","children":[{"tag":"button","children":[{"text":"{{confirm_btn}}","tag":"text"}],"onclick":"onSubmit()","css":"amc-btn-primary"}],"css":"amc-pd"}],"onkeydown":"onKeyDown()","css":"amc-i-body"}]},"format":"JSON","tplVersion":"5.0.8"}