{"time":"0013","tplId":"QUICKPAY@cashier-promotion-wait-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-promotion-wait-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"link","rel":"stylesheet","type":"text/css","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","children":[{"text":"var slaPng = amc.path + \"alipay_msp_sla\";\nvar sla11Png = amc.path + \"alipay_msp_sla11\";\n\nvar getTag = amc.fn.getById;\nvar rpc = amc.rpcData;\nvar isDoubleEleven = (rpc.isDoubleEleven == \"true\");\nvar countDownNum = 10;\nvar timer;\n//### 初始化\nfunction init() {\n    try {\n        initUI();\n        \n        if(amc.fn.logPageInit) {\n            amc.fn.logPageInit(true);\n        }\n    } catch(e) {\n        if(amc.fn.logPageInit) {\n            amc.fn.logPageInit();\n        }\n    }\n}\n\nfunction initUI() {\n    getTag('closeImg').src = amc.res.close;\n    getTag('slaImg').defaultvalue = slaPng;\n    if (isDoubleEleven){\n        getTag('slaImg').src = sla11Png;\n    } else {\n        getTag('slaImg').src = slaPng;\n    }\n    \n    if (rpc.slaRetryInterval != undefined){\n        countDownNum = rpc.slaRetryInterval;\n    }\n    \n    if(rpc.largeTip) {\n        getTag('largeTip').innerText = rpc.largeTip;\n    }\n    \n    if(rpc.smallTip) {\n        getTag('smallTip').innerText = rpc.smallTip;\n    }\n    \n    getTag('dlg').showModal();\n    timer = setInterval(countDown,1000);\n    countDown();\n}\n\n//### 重试\nfunction reTry(){\n    var obj={'action':{'name':'/cashier/sla' + \";loc:destroy('cashier-promotion-wait-flex')\"}}; //销毁视图\n    \n    //先close再销毁视图\n    getTag('dlg').close();\n    document.submit(obj);\n}\n\n//### 倒计时\nfunction countDown(){\n    var retryBtn = getTag('btnRetry');\n    if (countDownNum > 0){\n        retryBtn.disabled = true;\n        retryBtn.innerText = amc.fn.i18nPlaceholderReplace('{{retry_after_full}}', String(countDownNum));\n        countDownNum--;\n    } else {\n        retryBtn.className += 'font-bold';\n        retryBtn.innerText = '{{retry_again}}';\n        retryBtn.disabled = false;\n        if(timer){\n            clearInterval(timer);\n            timer = 0;\n        }\n    }\n}\n//### 退出\nfunction onBack() {\n    amc.fn.exitConfirm();\n}\n\n//### Android硬返回\nfunction onKeyDown(){\n    if(event.which == 4){\n        amc.fn.exitConfirm();\n    }\n}","tag":"text"}],"type":"text/javascript"},{"tag":"style","children":[{"text":".dlg-box{\n    width:270px;\n    background-color:#f8f8f8;\n    border-radius:5px;\n}\n.left-img-box{\n    padding: 12px 15px 15px 12px;\n    margin-top: 3px;\n    margin-left: 3px;\n    width: 45px;\n}\n.close-img-box{\n    width:15px;\n    height:15px;\n}\n\n.wait-text-color{color:#a5a5a5;}\n\n.retry-box {\n    margin-top: 21px;\n    height:42px;\n    border-radius: 5px;\n    justify-content: center;\n}\n.large-tip {\n    margin-top: 15px;\n    color: #000;\n    font-size: 17px;\n}\n.btn {\n    height: 42px;\n    border: 0px;\n    font-size:18px;\n    color: #fff;\n    border-radius: 5px;\n}\n.state{\n    background-color:#108ee9;\n    color: #fff;\n}\n.state:active {\n    color: #fff;\n    background-color:#0091CB;\n}\n.state:disabled {\n    background-color:#ccc;\n    color: #bbb;\n}\n.font-bold {\n    font-weight: bold;\n}\n.sla-box{\n    margin-top: 6px;\n}\n.small-tip-box {\n    margin: 9px 2px 0 2px;\n    padding: 3.5px 6px;\n    background-color: #faf0dc;\n    border-radius: 2px;\n}\n\n.small-tip {\n    font-size: 13px;\n    color: #f5a623;\n}\n\n.ellipsis-2-line {\n    -webkit-line-clamp:2;\n    -webkit-box-orient:vertical;\n    display:-webkit-box;\n}","tag":"text"}]}]},{"onload":"init()","tag":"body","children":[{"id":"dlg","tag":"dialog","children":[{"tag":"div","children":[{"id":"closeImg","alt":"{{exit}}","tag":"img","css":"close-img-box"}],"onclick":"onBack()","css":"left-img-box"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"div","children":[{"id":"slaImg","tag":"img"}],"css":"sla-box"},{"tag":"div","children":[{"id":"largeTip","tag":"label","children":[{"text":"{{promotion_crowd}}","tag":"text"}],"css":"large-tip ellipsis-2-line"}],"css":"amc-v-box"},{"tag":"div","children":[{"id":"smallTip","tag":"label","children":[{"text":"{{promotion_sorry}}","tag":"text"}],"css":"small-tip ellipsis-2-line"}],"css":"small-tip-box amc-v-box"}],"css":"amc-align-center amc-v-box"},{"tag":"div","children":[{"id":"btnRetry","tag":"button","children":[{"text":"{{wait_retry}}","tag":"text"}],"onclick":"reTry()","css":"btn amc-flex-1 state"}],"css":"retry-box"}],"css":"amc-pd-lr amc-v-box amc-pd-b"}],"onkeydown":"onKeyDown()","css":"dlg-box amc-v-box"}],"css":"amc-body amc-opacity"}]},"format":"JSON","tplVersion":"5.0.8"}