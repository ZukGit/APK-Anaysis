{"time":"0053","tplId":"WALLET-BILL@BLDetailCommonWithDialog","publishVersion":"150603","tag":"WALLET-BILL","name":"BLDetailCommonWithDialog","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"style","children":[{"text":"body, div {\n            display: flex;\n        }\n\n        .cell-common {\n            flex: 1;\n            align-items: flex-start;\n            margin: 0;\n            padding: 16px;\n            background-color: #fff;\n        }\n\n        .cell-title {\n            width: 72px;\n            font-size: 14px;\n            color: #666666;\n        }\n\n        .cell-flexbox {\n            flex: 1;\n            align-items: center;\n        }\n\n        .cell-content {\n            flex: 1;\n            font-size: 14px;\n            color: #999999;\n        }\n\n        .cell-arrow {\n            width: 9px;\n            height: 13px;\n            margin-left: 6px;\n        }\n\n        .dialog-main-title {\n            font-size: 16px;\n            color: #333;\n        }\n        .dialog-main-title-box{\n            height: 48px;\n            background-color: #fff;\n            padding-left: 14px;\n            flex-direction : column;\n            justify-content: center;\n        }\n        .dialog-title-wrap{\n            flex: 1;\n            flex-direction: column;\n        }\n \n        .dialog-close:active{\n            background-color: #efefef;\n        }\n\n        .dialog-content {\n            flex-direction: column;\n            align-items: center;\n        }\n        \n        .dialog-price{\n            justify-content: flex-end;\n        }\n\n        .dialog-item {\n            align-self: stretch;\n            height: 48px;\n            background-color: #fff;\n            align-items: center;\n            padding-left:14px;\n            padding-right:14px;\n        }\n        .dialog-item:active {\n            background-color: #ececec;\n        }\n        .dialog-flag {\n            padding: 2px;\n            padding-left: 4px;\n            font-size: 10px;\n            text-align: center;\n            margin-right: 7px;\n            color: #fff;\n            background-color: #00aaee;\n        }\n\n        .dialog-sum {\n            font-size: 15px;\n            color: #A9A9A9;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n        }\n        .dialog-box {\n            border-radius: 4px;\n            background-color: #fff;\n            flex-direction: column;\n        }\n        .dialog-title-line {\n            align-items: center;\n            margin-bottom: 5px;\n        }\n        .dialog-title {\n            font-size: 14px;\n            color: #000;\n            flex: 1;\n            overflow: hidden;\n            text-overflow: ellipsis;\n            white-space: nowrap;\n        }\n         .dialog-title-divider {\n            background-color: #dadada;\n            height: 1PX;\n        }\n         .dialog-item-divider {\n            background-color: #dadada;\n            height: 1PX;\n            margin-left: 14px;\n            margin-right: 14px;\n            align-self: stretch;\n        }","tag":"text"}]},{"tag":"script","children":[{"text":"var createElement = function (str) {\n            var splitSymbol = \";&\";\n\n            var tagName = /^\\w+/.exec(str)[0];\n            var el = document.createElement(tagName);\n            if (!el) return;\n\n            var className = /\\.([\\w-\\s]+)/gi.exec(str);\n            var idName = /#((\\-|[\\w])+)/i.exec(str);\n            if (className && className[1]) {\n                el.className = className[1];\n            }\n            if (idName && idName[1]) el.id = idName[1];\n            return el;\n        };\n\n        var Biz;\n\n        var updateDisplay = function () {\n            Node.cellCommon.id = Biz.id;\n            Node.title.innerText = Biz.title;\n            Node.content.innerText = Biz.content;\n            Node.arrow.style.display = Biz.goto ? 'flex' : 'none';\n        };\n        \n        var updateDialog = function () {\n            print(\"start updateDialog:\" + JSON.stringify(Biz));\n            if(!Biz.subContent || Biz.subContent.length == 0){return;}\n            print(\"dialog content:\" + Biz.subContent.length);\n            Node.dlgContent.innerHTML = '';\n            for (var i = 0; i < Biz.subContent.length; i++) {\n                var content = Biz.subContent[i];\n                print(\"dialog content detail-\"  + i + \":\"+ JSON.stringify(content));\n                Node.dlgItem = createElement('div.dialog-item');\n                Node.dlgFlag = createElement('label.dialog-flag');\n                Node.dlgTitle = createElement('label.dialog-title');\n                Node.dlgTitle.emoji = true;\n                Node.dlgPrice = createElement('div.dialog-price');\n                Node.dlgSum = createElement('label.dialog-sum');\n                Node.dlgImage = createElement('img.cell-arrow');\n                Node.dlgImage.src = 'com.alipay.mobile.bill.detail/bill_list_arrow_right';\n                Node.dlgDivider = createElement('div.dialog-item-divider');\n            \n\n                Node.dlgItem.appendChild(Node.dlgTitleWrap);\n                Node.dlgItem.appendChild(Node.dlgFlag);\n                Node.dlgItem.appendChild(Node.dlgTitle);\n                Node.dlgItem.appendChild(Node.dlgPrice);\n                Node.dlgItem.appendChild(Node.dlgImage);\n                Node.dlgPrice.appendChild(Node.dlgSum);\n\n                Node.dlgFlag.style.display = Biz.bizInNo == content.bizInNo ? 'flex' : 'none';\n                Node.dlgFlag.innerText = '当前';\n                Node.dlgTitle.innerText = content.title;\n                Node.dlgSum.innerText = content.money;\n                \n                if (Biz.bizInNo == content.bizInNo) {\n                    print(\"current bizNo：\" + content.bizInNo);\n                    Node.dlgImage.style.display = 'none';\n                    Node.dlgItem.onclick = function() {\n                        Node.dialog.close();\n                    };\n                }else if (content.bizInNo && content.bizInNo != ''){\n                    Node.dlgImage.style.display = 'flex';\n                    var url;\n                    if(content.autoJumpUrl && content.autoJumpUrl != ''){\n                        url = content.autoJumpUrl;\n                    }else{\n                        url = \"alipays://platformapi/startapp?appId=20000090&actionType=toDetailDirectly&clearTop=NO&tradeNO=\" + content.bizInNo;\n                    }\n                    (function(url){\n                        Node.dlgItem.onclick = function() {\n                        Node.dialog.close();\n                        print(\"open url on click：\" + url);\n                        document.openURL(url);\n                     };\n                    })(url);\n                }else {\n                    Node.dlgImage.style.display = 'none';\n                    Node.dlgItem.onclick = null;\n                }\n                Node.dlgContent.appendChild(Node.dlgItem);  \n                Node.dlgContent.appendChild(Node.dlgDivider);   \n            }\n        };\n\n        function init() {\n            window.Node = {\n                cellCommon: document.querySelector('.cell-common'),\n                title: document.querySelector('.cell-title'),\n                content: document.querySelector('.cell-content'),\n                arrow: document.querySelector('.cell-arrow'),\n                dialog: document.getElementById('dialog'),\n                dlgContent: document.querySelector('.dialog-content'),\n            };\n\n            Node.dialog.style.width = '300px';\n\n            Node.cellCommon.onclick = function () {\n                if (!Biz.goto) return;\n                Node.cellCommon.id = Biz.id;\n                var data = {\"groupBizNo\": Biz.groupBizNo, \"groupBizType\": Biz.groupBizType};\n                document.asyncSubmit({\"goto\" : \"gotoRelatedList\", \"data\": data}, function(rsp) {\n                    if (rsp && rsp.data.length > 0) {\n                        print(\"native data valied2:\" + JSON.stringify(rsp.data));\n                        Biz.subContent = rsp.data;\n                        Biz.bizInNo = rsp.bizInNo;\n                        updateDialog();\n                        Node.dialog.showModal();\n                    }\n                });\n            };\n            document.onreload = function (data) {\n                Biz = data;\n                updateDisplay();\n            };\n        }","tag":"text"}]}]},{"onload":"init();","tag":"body","children":[{"tag":"div","children":[{"tag":"label","css":"cell-title"},{"tag":"div","children":[{"tag":"label","emoji":"true","css":"cell-content"},{"tag":"img","src":"com.alipay.mobile.bill.detail/bill_list_arrow_right","css":"cell-arrow"}],"css":"cell-flexbox"}],"css":"cell-common"},{"id":"dialog","tag":"dialog","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"全部关联记录","tag":"text"}],"css":"dialog-main-title"}],"css":"dialog-main-title-box"},{"tag":"div","css":"dialog-title-divider"},{"tag":"div","css":"dialog-content"}],"css":"dialog-box"}]}]},"format":"JSON","tplVersion":"5.0.6"}