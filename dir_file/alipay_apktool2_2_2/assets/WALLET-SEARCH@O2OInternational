{"time":"0054","tplId":"WALLET-SEARCH@O2OInternational","publishVersion":"150603","tag":"WALLET-SEARCH","name":"O2OInternational","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"style","children":[{"text":"div {\n            display: flex;\n            flex-direction: row;\n        }\n\n        .cell {\n            flex: 1;\n            background-color: #ffffff;\n            padding: 10px 14px;\n        }\n\n        .cell:active {\n            background-color: #e4e4e4;\n        }\n\n        .cell-info {\n            flex: 1;\n            display: flex;\n            flex-direction: column;\n            justify-content: center;\n            margin-left: 10px;\n            margin-top: auto;\n            margin-bottom: auto;\n        }\n\n        .cell-info-sep {\n            font-size: 11px;\n            color: #9FA0A0;\n            text-align: left;\n            margin-right: 5px;\n        }\n\n        .cell-info-sep2 {\n            font-size: 11px;\n            margin-left: 2px;\n            margin-right: 2px;\n        }\n\n        .cell-image-container {\n            width: 50px;\n            height: 50px;\n        }\n\n        .cell-image {\n            width: 50px;\n            height: 50px;\n        }\n\n        .cell-info-title-container {\n            flex-direction: row;\n            align-items: center;\n        }\n\n        .cell-info-title {\n            font-size: 16px;\n            color: #2a2b2c;\n            text-align: left;\n            margin-right: 5px;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            overflow: hidden;\n            max-width: 250px;\n        }\n\n        .pluginicon-container {\n            display: none;\n            flex-direction: row;\n            align-items: center;\n            display: flex;\n        }\n\n        .cell-info-score {\n            align-items: center;\n            height: 17px;\n        }\n\n        .cell-info-evaluate {\n            height: 12px;\n            width: 65px;\n        }\n\n        .cell-info-fee {\n            margin-left: 8px;\n            font-size: 11px;\n            color: #a3a3a4;\n            text-align: left;\n            font-family: \"PingFangSC-Regular\";\n        }\n\n        .cell-info-evaluate-img {\n            height: 12px;\n            width: 65px;\n        }\n\n        .cell-info-tags {\n            align-items: center;\n            flex-direction: row;\n        }\n\n        .cell-info-feature-desc {\n            font-size: 11px;\n            color: #888888;\n            text-align: left;\n            text-overflow: ellipsis;\n            -webkit-line-clamp: 1;\n            -webkit-box-orient: vertical;\n            display: -webkit-box;\n            max-width: 250px;\n        }\n\n        .cell-discount {\n            flex-direction: row;\n            align-items: center;\n            margin-top: 2px;\n        }\n\n        .cell-discount-label-num {\n            font-size: 11px;\n            color: #f96268;\n            text-align: left;\n            overflow: hidden;\n            margin-right: 5px;\n        }\n\n        .promotion-container {\n            display: flex;\n            flex-direction: row;\n            align-items: center;\n        }\n\n        .cell-openshop {\n            position: absolute;\n        }\n\n        .cell-openshop-label {\n            right: 15px;\n            top: 3px;\n            color: #888888;\n            font-size: 11px;\n            background-color: #ffffff;\n            border-radius: 3px;\n            border: 1PX solid #f96268;\n            text-align: center;\n            vertical-align: middle;\n            text-overflow: ellipsis;\n        }\n\n        .score-label {\n            text-align: left;\n            margin-left: 6px;\n            font-size: 11px;\n            margin-top: 1px;\n            color: #f96268;\n            text-align: left;\n        }\n\n        .promotion-icon{\n            height: 15px;\n            width: 15px;\n            margin-left: 2px;\n            display: flex;\n        }\n\n        .plugin-icon {\n            height: 15px;\n            width: 15px;\n            margin-right: 3px;\n        }\n\n        .list_line {\n            height: 1PX;\n            flex: 1;\n            background-color: #e0e0e0;\n            margin-left: 14px;\n        }","tag":"text"}],"type":"text/css"},{"tag":"script","children":[{"text":"var cellImage;\n        var cellInfoTitle;\n        var cellInfoEvaluateScore;\n        var cellInfoDistrict;\n        var cellDiscountLabelNum;\n        var cellOpenShopLabelTip;\n        var discount_right;\n        var cellInfoFee;\n        var cellInfoDistance;\n        var cellInfoCuisine;\n        var cellInfoSep;\n        var cellInfoSep1;\n        var scoreNumLabel;\n        var line;\n\n        function isValidStr(str) {\n            return (str && ( typeof str == 'string') && str.length > 0);\n        }\n\n        function safeString(str) {\n            return str ? str : \"\";\n        }\n\n        var openUrl = function (url) {\n            document.openURL(url);\n        }\n\n        function byId(id) {\n            return document.getElementById(id);\n        }\n\n        function byCls(name) {\n            return document.getElementsByClassName(name);\n        }\n\n\n        function init() {\n\n            cellImage = byId(\"cellImage\");\n            cellInfoTitle = byId(\"cellInfoTitle\");\n            cellInfoEvaluateScore = byId(\"cellInfoEvaluateScore\");\n            cellInfoDistrict = byId(\"cellInfoDistrict\");\n            cellDiscountLabelNum = byId(\"cellDiscountLabelNum\");\n            cellOpenShopLabelTip = byId(\"cellOpenShopLabelTip\");\n            cellInfoFee = byId(\"cellInfoFee\");\n            cellInfoDistance = byId(\"cellInfoDistance\");\n            cellInfoCuisine = byId(\"cellInfoCuisine\");\n            cellInfoSep = byId(\"cellInfoSep\");\n            cellInfoSep1 = byId(\"cellInfoSep1\");\n            scoreNumLabel = byId(\"scoreNum\");\n            line = document.getElementById(\"normal-row\");\n        }\n\n        document.onreload = function (data) {\n\n            cellImage.src = data.shopLogoUrl ? data.shopLogoUrl : \"com.alipay.android.phone.businesscommon.globalsearch/loading_img_fail\";\n\n            cellInfoTitle.innerText = data.shopName ? data.shopName : \"\";\n\n            // pluginInfos字段对应的信息，显示“订”“排”“点”“外”等\n            var pluginInfoContainer = document.getElementById(\"pluginInfoContainer\");\n            pluginInfoContainer.innerHTML = \"\";\n            var pluginInfoArray = data.pluginInfos;\n            if (pluginInfoArray && (pluginInfoArray.length > 0)) {\n                for (var i = 0; i < pluginInfoArray.length; i++) {\n                    var pluginInfo = pluginInfoArray[i];\n                    if (pluginInfo.length > 0) {\n                        var pluginIcon = document.createElement(\"img\");\n                        pluginIcon.className = \"plugin-icon\";\n                        pluginIcon.src = pluginInfo;\n                        pluginInfoContainer.appendChild(pluginIcon);\n                    }\n                }\n            }\n\n            // 全民开店和折扣区块，有折扣展示折扣，没有折扣再判定是不是全民开店\n            var isQMKD = 0; // 标记是否全民开店\n            cellOpenShopLabelTip.style.display = \"none\";\n            cellDiscountLabelNum.style.display = \"none\";\n            if (isValidStr(data.itemDiscount) && isValidStr(data.itemUnit)) {\n                var discount = data.itemDiscount + data.itemUnit;\n                cellDiscountLabelNum.innerText = discount ? discount : \"\";\n                cellOpenShopLabelTip.style.display = \"none\";\n                cellDiscountLabelNum.style.display = \"flex\";\n            }\n            else if (isValidStr(data.shopTopicType) && data.shopTopicType == \"quanminkaidian\") {\n                var remindText = safeString(data.shopTopicDesc);\n                print(remindText);\n                if (remindText == \"\") {\n                    cellOpenShopLabelTip.style.display = \"none\";\n                } else {\n                    var openData = remindText;\n                    var pointIndex = openData.indexOf('\\n');\n                    var open_start = \"<font size = 8>\" + (pointIndex < 0 ? openData : openData.substring(0, pointIndex + 1)) + \"</font>\";\n                    var open_end = pointIndex < 0 || openData.length <= pointIndex + 1 ? '' : '<font size = 17>' + openData.substring(pointIndex + 1, openData.length) + '</font>';\n                    print(open_end);\n                    cellOpenShopLabelTip.innerText = open_start + open_end;\n                    print(cellOpenShopLabelTip.innerText);\n                    cellOpenShopLabelTip.style.display = \"flex\";\n                    isQMKD = 1; // 标记是全民开店\n                }\n                cellDiscountLabelNum.style.display = \"none\";\n            }\n\n            // 打分“星级”\n            if (data.shopScore != undefined) {\n                byId(\"cellInfoScore\").style.display = 'flex';\n                var width = Number(data.shopScore) * 13;\n                if (width <= 0) {\n                    cellInfoEvaluateScore.style.display = \"none\";\n                    scoreNumLabel.style.display = 'none';\n                } else {\n                    cellInfoEvaluateScore.style.display = \"flex\";\n                    scoreNumLabel.style.display = 'none';\n                    scoreNumLabel.innerText = data.shopScore;\n                }\n                cellInfoEvaluateScore.style.width = width + \"px\";\n                cellInfoFee.innerText = data.averagePrice ? data.averagePrice : \"\";\n                // 如果没有评分也没有人均,隐藏整个cell条\n                if (data[\"shopScore\"] < -0.5 && !isValidStr(data.averagePrice)) {\n                    byId(\"cellInfoScore\").style.display = \"none\";\n                }\n            } else {\n                if (data.averagePrice) {\n                    byId(\"cellInfoEvaluate\").style.display = 'none';\n                    byId(\"scoreNum\").style.display = 'none';\n                    cellInfoFee.innerText = data.averagePrice;\n                } else {\n                    byId(\"cellInfoScore\").style.display = 'none';\n                }\n            }\n\n            // 菜系；区域；距离\n            // 初始化，将各个label设置为不展示\n            byId(\"cellInfoTags\").style.display = \"flex\";\n            cellInfoCuisine.innerText = safeString(data.shopLabel);\n            cellInfoDistrict.innerText = safeString(data.shopDistrict); // 商圈\n            cellInfoDistance.innerText = safeString(data.distance);\n            cellInfoSep.style.display = 'none';\n            cellInfoSep1.style.display = 'none';\n            cellInfoCuisine.style.display = 'none';\n            cellInfoDistrict.style.display = 'none';\n            cellInfoDistance.style.display = 'none';\n\n            // 如果有菜系\n            if (isValidStr(data.shopLabel)) {\n                // 展示菜系，判定后面是否有区域和距离，如果有一个，则后面的短线必展示，否则不展示\n                cellInfoCuisine.style.display = \"-webkit-box\";\n\n                if (isValidStr(data.shopDistrict)) {\n                    cellInfoSep.style.display = \"-webkit-box\";\n                } else {\n                    cellInfoSep.style.display = \"none\";\n                }\n            }\n            else {\n                cellInfoSep.style.display = \"none\";\n            }\n            // 判断是否有区域字段\n            if (isValidStr(data.shopDistrict)) {\n                // 有区域就展示，如果有距离，则他后面的短线也会展示，否则不展示\n                cellInfoDistrict.style.display = \"-webkit-box\";\n            }\n            if (isValidStr(data.distance)) {\n                if (isValidStr(data.shopDistrict) || isValidStr(data.shopLabel)) {\n                    cellInfoSep1.style.display = '-webkit-box';\n                } else {\n                    cellInfoSep1.style.display = 'none';\n                }\n\n                cellInfoDistance.style.display = \"-webkit-box\";\n            }\n            if (cellInfoCuisine.style.display == \"none\"\n                    && cellInfoDistrict.style.display == \"none\"\n                    && cellInfoDistance.style.display == \"none\") {\n                byId(\"cellInfoTags\").style.display = \"none\";\n            }\n\n            // promotionInfos字段对应的促销信息，比如“减”“送”“券”\n            var promotionContainer = document.getElementById(\"promotionContainer\");\n            promotionContainer.innerHTML = \"\";\n            if (data.promotionInfos && (data.promotionInfos.length > 0)) {\n                var promotinoInfoArray = data.promotionInfos;\n                for (var i = 0; i < promotinoInfoArray.length; i++) {\n                    var promotionInfo = promotinoInfoArray[i];\n                    if (promotionInfo && promotionInfo.icon && (promotionInfo.icon.length > 0)) {\n                        var promotionImg = document.createElement(\"img\");\n                        promotionImg.className = \"promotion-icon\";\n                        promotionImg.src = promotionInfo.icon;\n                        promotionContainer.appendChild(promotionImg);\n                    }\n                }\n            }\n\n            // 重新设置全民开店和折扣的位置\n            var tmpCellLineCnt = 0;\n            if (byId(\"cellInfoScore\").style.display == \"flex\") {\n                tmpCellLineCnt++;\n            }\n            if (byId(\"cellInfoTags\").style.display == \"flex\") {\n                tmpCellLineCnt++;\n            }\n            var placeholderCell1 = byId(\"placeholderCell1\");\n            var placeholderCell2 = byId(\"placeholderCell2\");\n            if (placeholderCell1) {\n                placeholderCell1.style.display = \"none\";\n            }\n            if (placeholderCell2) {\n                placeholderCell2.style.display = \"none\";\n            }\n\n            if (tmpCellLineCnt == 1) {\n//                byId(\"cellDiscount\").style.top = 35;\n                if ((isQMKD == 1) && placeholderCell1) {\n                    placeholderCell1.style.display = \"flex\";\n                }\n            }\n            else if (tmpCellLineCnt == 0) {\n                if (placeholderCell1) {\n                    placeholderCell1.style.display = \"flex\";\n                }\n                if (isQMKD && placeholderCell2) {\n                    placeholderCell2.style.display = \"flex\";\n                }\n            }\n\n            if(data[\"isLastItem\"]) {\n                line.style.display = \"flex\";\n            }else{\n                line.style.display = \"none\";\n            }\n\n        };","tag":"text"}],"type":"text/javascript"}]},{"id":"cell","style":"flex-direction:column;","onload":"init()","tag":"body","children":[{"id":"cell_item","tag":"div","children":[{"tag":"div","children":[{"id":"cellImage","contentmode":"ScaleAspectFill","tag":"img","src":"com.alipay.android.phone.businesscommon.globalsearch/loading_img_fail","defaultvalue":"com.alipay.android.phone.businesscommon.globalsearch/loading_img_fail","css":"cell-image","failurevalue":"com.alipay.android.phone.businesscommon.globalsearch/loading_img_fail"}],"css":"cell-image-container"},{"id":"cellInfo","tag":"div","children":[{"tag":"div","children":[{"id":"cellInfoTitle","tag":"label","css":"cell-info-title"},{"id":"pluginInfoContainer","tag":"div","css":"pluginicon-container"}],"css":"cell-info-title-container"},{"id":"cellInfoScore","tag":"div","children":[{"id":"cellInfoEvaluate","tag":"div","children":[{"tag":"img","src":"com.alipay.android.phone.businesscommon.globalsearch/star_gray","css":"cell-info-evaluate-img"},{"id":"cellInfoEvaluateScore","style":"position:absolute; left:0px; top:0px; overflow:hidden;","tag":"div","children":[{"tag":"img","src":"com.alipay.android.phone.businesscommon.globalsearch/star_highlight","css":"cell-info-evaluate-img"}]}],"css":"cell-info-evaluate"},{"id":"scoreNum","tag":"label","children":[{"text":"4.0","tag":"text"}],"css":"score-label"},{"id":"cellInfoFee","tag":"label","children":[{"text":"c","tag":"text"}],"css":"cell-info-fee"}],"css":"cell-info-score"},{"id":"cellInfoTags","tag":"div","children":[{"id":"cellInfoCuisine","tag":"label","children":[{"text":"aa","tag":"text"}],"css":"cell-info-feature-desc"},{"id":"cellInfoSep","tag":"label","children":[{"text":"&nbsp;·","tag":"text"}],"css":"cell-info-sep"},{"id":"cellInfoDistrict","tag":"label","children":[{"text":"bb","tag":"text"}],"css":"cell-info-feature-desc"},{"id":"cellInfoSep1","tag":"label","children":[{"text":"&nbsp;·","tag":"text"}],"css":"cell-info-sep2"},{"id":"cellInfoDistance","tag":"label","children":[{"text":"cc","tag":"text"}],"css":"cell-info-feature-desc"}],"css":"cell-info-tags"},{"id":"cellDiscount","tag":"div","children":[{"id":"cellDiscountLabelNum","tag":"label","children":[{"text":"9","tag":"text"}],"css":"cell-discount-label-num"},{"id":"promotionContainer","tag":"div","css":"promotion-container"}],"css":"cell-discount"}],"css":"cell-info"},{"id":"cellOpenshop","tag":"div","children":[{"id":"cellOpenShopLabelTip","tag":"label","children":[{"text":"g","tag":"text"}],"css":"cell-openshop-label"}],"css":"cell-openshop"}],"css":"cell"},{"style":"display:flex; background-color:#ffffff;","tag":"div","children":[{"id":"normal-row","tag":"div","css":"list_line"}]}]}]},"format":"JSON","tplVersion":"5.0.6"}