{"time":"0002","tplId":"WALLET-FWC@PPDetailLastNews","publishVersion":"150603","tag":"WALLET-FWC","name":"PPDetailLastNews","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"style","children":[{"text":"body {\n            -webkit-flex-direction: column;\n            flex-direction: column;\n            margin: 0px;\n        }\n        \n        div {\n            display: -webkit-flex;\n            display: flex;\n            flex-direction: row;\n            position: relative;\n        }\n        \n        .contentDiv {\n          \tmargin-top: 16px;\n            margin-left: 16px;\n            margin-right: 16px;\n            margin-bottom: 16px;\n        }\n        \n        .contentLeftDiv {\n            flex: 1;\n            flex-shrink: 1;\n            flex-direction: column;\n        }\n        \n        .content-label {\n            font-size: 16px;\n            color: #333333;\n            line-height: 22px;\n            display: -webkit-box;\n               -webkit-line-clamp: 2;\n            -webkit-box-orient: vertical;\n            text-overflow: ellipsis;\n            overflow: hidden;\n        }\n        \n        .content-activity-container-div {\n            flex: 1;\n            flex-shrink: 1;\n            margin-top: 6px;\n            margin-bottom: 3px;\n            height: 20px;\n        }\n        \n        .content-activity-div {\n            flex-shrink: 1;\n            flex-direction: column;\n            justify-content: center;\n            background-color: rgba(254, 231, 231, 0.4);\n            border-radius: 2px;\n            margin-right: 8px;\n        }\n        \n        .content-activity-label {\n            font-size: 12px;\n            color: #F85458;\n            margin-left: 4.5px;\n            margin-right: 4.5px;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            overflow: hidden;\n        }\n        \n        .content-membership-label {\n            font-size: 12px;\n            color: #F85458;\n            margin-left: 4.5px;\n            margin-right: 4.5px;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            overflow: hidden;\n        }\n        \n        .content-extra-div {\n            flex: 1;\n            flex-shrink: 1;\n            margin-top: 6px;\n            align-items: center;\n        }\n        \n        .content-extra-label {\n            font-size: 12px;\n            color: #999999;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            overflow: hidden;\n        }\n        \n        .content-readCount-div {\n            margin-right: 18px;\n            align-items: center;\n        }\n        \n        .content-readCount-img {\n            width: 14px;\n            height: 10px;\n            margin-right: 5px;\n        }\n        \n        .content-commentCount-div {\n            margin-right: 18px;\n            align-items: center;\n        }\n        \n        .content-commentCount-img {\n            width: 12px;\n            height: 12px;\n            margin-right: 5px;\n        }\n        \n        .content-img {\n            flex: 0;\n            flex-shrink: 0;\n            height: 64px;\n            width: 88px;\n            margin-left: 10px;\n            border-radius: 2px;\n        }\n        \n        .content-tag-div {\n            position: absolute;\n            background-color: #F17337;\n            height: 16px;\n            right: 0px;\n            top: 0px;\n        }\n        \n        .content-tag-label {\n            font-size: 12px;\n            color: #ffffff;\n            margin-left: 4px;\n            margin-right: 4px;\n            max-width: 80px;\n            white-space: nowrap;\n            text-overflow: ellipsis;\n            overflow: hidden;\n        }","tag":"text"}],"type":"text/css"},{"tag":"script","children":[{"text":"var hasActivityStr = false;\n        var hasMemberShipStr = false;\n\n        function isValidStr(str) {\n            return (str && (typeof str == 'string') && str.length > 0);\n        }\n\n        function isValidArray(o) {\n            return Object.prototype.toString.call(o) == '[object Array]';\n        }\n\n        function convertToNum(value) {\n            return ((typeof(value) == 'string' || typeof(value) == 'number')) ?\n                parseInt(value + '') : 0;\n        }\n\n        function updateRealTimeData(node, realTimeStr) {\n            // set icon image, max width\n            var system = document.platform;\n            if (system == \"iOS\") {\n                node.contentReadCountImg.src = 'Life.bundle/life_follow_read';\n                node.contentCommentCountImg.src = 'Life.bundle/life_follow_comment';\n                node.contentActivityLabel.style.maxWidth = '140px';\n                node.contentMembershipLabel.style.maxWidth = '90px';\n                var screenWidth = window.innerWidth;\n                if (screenWidth < 375) {\n                    node.contentActivityLabel.style.maxWidth = '110px';\n                    node.contentMembershipLabel.style.maxWidth = '70px';\n                }\n            } else if (system == \"android\") {\n                node.contentReadCountImg.src = 'android-phone-wallet-ppchat/com.alipay.mobile.pubsvc/icon_follow_read';\n                node.contentCommentCountImg.src = 'android-phone-wallet-ppchat/com.alipay.mobile.pubsvc/icon_follow_comment';\n                node.contentActivityLabel.style.maxWidth = '140px';\n                node.contentMembershipLabel.style.maxWidth = '90px';\n            }\n            var onlyOneStr = (!hasMemberShipStr && hasActivityStr) || (hasMemberShipStr && !hasActivityStr);\n            if (onlyOneStr) {\n                node.contentActivityLabel.style.maxWidth = '180px';\n                node.contentMembershipLabel.style.maxWidth = '180px';\n            }\n\n            if (isValidStr(realTimeStr)) {\n                var realTimeDict = JSON.parse(realTimeStr);\n                if (realTimeDict) {\n                    var readCount = realTimeDict.readCount;\n                    var commentCount = realTimeDict.commentCount;\n                    var tag = realTimeDict.tag;\n                    if (isValidStr(readCount)) {\n                        node.contentReadCountLabel.innerText = readCount;\n                        node.contentReadCountDiv.style.display = 'flex';\n                    } else {\n                        node.contentReadCountDiv.style.display = 'none';\n                        node.contentReadCountLabel.innerText = '';\n                    }\n                    if (isValidStr(commentCount)) {\n                        node.contentCommentCountLabel.innerText = commentCount;\n                        node.contentCommentCountDiv.style.display = 'flex';\n                    } else {\n                        node.contentCommentCountDiv.style.display = 'none';\n                        node.contentCommentCountLabel.innerText = '';\n                    }\n                    if (isValidStr(tag)) {\n                        node.contentTagLabel.innerText = tag;\n                        node.contentTagDiv.style.display = 'flex';\n                    } else {\n                        node.contentTagDiv.style.display = 'none';\n                        node.contentTagLabel.innerText = '';\n                    }\n                }\n            } else {\n                node.contentReadCountDiv.style.display = 'none';\n                node.contentCommentCountDiv.style.display = 'none';\n                node.contentTagDiv.style.display = 'none';\n            }\n        }\n\n        function updateLatestMsg(node, data) {\n            // content img\n            if (isValidStr(data.imageUrl)) {\n                node.contentImg.src = data.imageUrl;\n                node.contentImg.style.display = \"flex\";\n            } else {\n                node.contentImg.src = \"\";\n                node.contentImg.style.display = \"none\";\n            }\n            // title\n            var titleString = data.title;\n            if (isValidStr(titleString)) {\n                titleString = \"<font color=\\\"#333333\\\" size=\\\"16\\\">\" + titleString + \"</font>\";\n            } else {\n                titleString = \"\";\n            }\n            // desc activity\n            var ctype = data.ctype;\n            var activityStr, descStr;\n            if (ctype == 'activity') {\n                activityStr = data.desc;\n            } else {\n                descStr = data.desc;\n            }\n            if (isValidStr(descStr)) {\n                descStr = \"<font color=\\\"#999999\\\" size=\\\"12\\\">\" + descStr + \"</font>\";\n                titleString = titleString + \"\\n\" + descStr;\n            }\n            node.contentTitle.innerText = titleString;\n\n            // activity\n            if (isValidStr(activityStr)) {\n                hasActivityStr = true;\n                node.contentActivityDiv.style.display = 'flex';\n                node.contentActivityLabel.innerText = activityStr;\n            } else {\n                hasActivityStr = false;\n                node.contentActivityDiv.style.display = 'none';\n                node.contentActivityLabel.innerText = '';\n            }\n            // membership\n            var membershipStr;\n            var linkTagsArray = data.linkTags;\n            if (isValidArray(linkTagsArray)) {\n                for (var i = 0; i < linkTagsArray.length; i++) {\n                    var serviceDict = linkTagsArray[i];\n                    var serviceType = serviceDict.serviceType;\n                    if (serviceType == 'MEMBERSHIP_CARD') {\n                        membershipStr = serviceDict.serviceTitle;\n                    }\n                }\n            }\n\n            if (isValidStr(membershipStr)) {\n                hasMemberShipStr = true;\n                node.contentMembershipDiv.style.display = 'flex';\n                node.contentMembershipLabel.innerText = membershipStr;\n            } else {\n                hasMemberShipStr = false;\n                node.contentMembershipDiv.style.display = 'none';\n                node.contentMembershipLabel.innerText = '';\n            }\n            // membership，activity都不存在的情况下需要隐藏整个div\n            if (!hasActivityStr && !hasMemberShipStr) {\n                node.contentActivityContainerDiv.style.display = 'none';\n            } else {\n                node.contentActivityContainerDiv.style.display = 'flex';\n            }\n        }\n\n        function init() {\n            var node = {\n                // 主内容\n                contentDiv: document.querySelector('.contentDiv'),\n                contentTitle: document.querySelector('.content-label'),\n                // 利益点、会员卡父div\n                contentActivityContainerDiv: document.querySelector('.content-activity-container-div'),\n                // 利益点\n                contentActivityDiv: document.querySelector('#content-activity-div'),\n                contentActivityLabel: document.querySelector('#content-activity-label'),\n                // 会员卡\n                contentMembershipDiv: document.querySelector('#content-membership-div'),\n                contentMembershipLabel: document.querySelector('#content-membership-label'),\n                // 阅读数\n                contentReadCountDiv: document.querySelector('.content-readCount-div'),\n                contentReadCountLabel: document.querySelector('#content-readCount-label'),\n                contentReadCountImg: document.querySelector('.content-readCount-img'),\n                // 评论数\n                contentCommentCountDiv: document.querySelector('.content-commentCount-div'),\n                contentCommentCountLabel: document.querySelector('#content-commentCount-label'),\n                contentCommentCountImg: document.querySelector('.content-commentCount-img'),\n                // 时间\n                contentTime: document.querySelector('#content-time-label'),\n                // 主图片\n                contentImg: document.querySelector('.content-img'),\n                // 标签\n                contentTagDiv: document.querySelector('.content-tag-div'),\n                contentTagLabel: document.querySelector('.content-tag-label'),\n            };\n\n            document.onreload = function(data) {\n\n                // content sum\n                updateLatestMsg(node, data);\n\n                // time\n                node.contentTime.innerText = data.msgTimeFormatted ? data.msgTimeFormatted : \"\";\n\n                // readcount, commentcount, tag\n                updateRealTimeData(node, data.realTimeData);\n            };\n        }","tag":"text"}],"type":"text/javascript"}]},{"style":"flex-direction: column","onload":"init();","tag":"body","children":[{},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","css":"content-label"},{"tag":"div","children":[{"id":"content-activity-div","tag":"div","children":[{"id":"content-activity-label","tag":"label","css":"content-activity-label"}],"css":"content-activity-div"},{"id":"content-membership-div","tag":"div","children":[{"id":"content-membership-label","tag":"label","css":"content-membership-label"}],"css":"content-activity-div"}],"css":"content-activity-container-div"},{"tag":"div","children":[{"tag":"div","children":[{"id":"content-readCount-img","tag":"img","contentMode":"ScaleAspectFit","defaultvalue":"Life.bundle/life_follow_read","css":"content-readCount-img"},{"id":"content-readCount-label","tag":"label","css":"content-extra-label"}],"css":"content-readCount-div"},{"tag":"div","children":[{"id":"content-commentCount-img","tag":"img","contentMode":"ScaleAspectFit","defaultvalue":"Life.bundle/life_follow_comment","css":"content-commentCount-img"},{"id":"content-commentCount-label","tag":"label","css":"content-extra-label"}],"css":"content-commentCount-div"},{"id":"content-time-label","tag":"label","css":"content-extra-label"}],"css":"content-extra-div"}],"css":"contentLeftDiv"},{"style":"background-color:#d8d8d8","tag":"img","contentMode":"ScaleAspectFill","css":"content-img"},{"tag":"div","children":[{"tag":"label","css":"content-tag-label"}],"css":"content-tag-div"}],"css":"contentDiv"}],"css":"body"}]},"format":"JSON","tplVersion":"5.2.0"}