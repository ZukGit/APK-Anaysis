{"time":"0002","tplId":"QUICKPAY@pcreditpay-sign-flex","publishVersion":"150924","tag":"QUICKPAY","name":"pcreditpay-sign-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"meta","locale":{"en_US":{"agree_auth_fp":"Use fingerprint or","click_agree":"I confirm"},"zh_TW":{"agree_auth_fp":"同意協議並驗證指紋或","click_agree":"點擊按鈕即同意"},"zh_HK":{"agree_auth_fp":"同意協議並驗證指紋或","click_agree":"點擊按鈕即同意"},"zh_CN":{"agree_auth_fp":"同意协议并验证指纹或","click_agree":"点击按钮即同意"}},"type":"i18n"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","children":[{"text":"amc.fn.spmPageCreate(\"a283.b5789\");var rpc=amc.rpcData;var getTag=amc.fn.getById;var hide=amc.fn.hide;var show=amc.fn.show;var androidFingerPng=amc.path+\"alipay_msp_finger\";var pcreditPayPng=amc.path+\"alipay_msp_pcredit\";var confirmPayText=rpc.confirmPay||\"{{open_pcredit_and_pay}}\";var creditAmount=rpc.creditAmount||\"0\";var dueDay=rpc.dueDay||\"\";var fingerPay=rpc.fingerPay||false;if(rpc.AndroidFingerStatus===\"1\"){fingerPay=false}var wearablePay=rpc.wearablePay;var wearablePayText=\"{{auth_bic}}\";var payAction=rpc.payAct||\"/cashier/pay\";var paySuccess=false;var isIOS83=amc.isIOS&&(amc.fn.versionCompare&&amc.fn.versionCompare(amc.osVersion,\"8.1.3\")>=0);if(fingerPay&&isIOS83){var fpCancelAction=rpc.pageSwitch&&rpc.pageSwitch.fpCancelAction}if(!wearablePay){wearablePay=rpc.braceletPay;wearablePayText=\"{{auth_bracelet}}\"}var isAndroidFingerPayHuawei=(amc.isAndroid&&fingerPay&&rpc.fpProtocolType==\"2\");var isResume=false;var spmExposure=amc.fn.spmExposure;var spmClicked=amc.fn.spmClick;function init(){try{initUI();if(amc.fn.logPageInit){amc.fn.logPageInit(true)}}catch(a){if(amc.fn.logPageInit){amc.fn.logPageInit()}}}function initUI(){var c=amc.fn.iNav(amc.res.arrowLeft,rpc.pageTitle||\"{{open_pcredit_service}}\",null,null,onBack,null);getTag(\"btnText\").innerText=confirmPayText;getTag(\"body\").insertBefore(c,getTag(\"titleLine\"));spmExposure(\"a283.b5789.c12705.d23268\");getTag(\"pcreditPayLogo\").src=pcreditPayPng;getTag(\"creditAmount\").innerText=rpc.creditMsg||amc.fn.i18nPlaceholderReplace(\"{{credit_quota_full}}\",'<font size=\"22\">'+creditAmount+\"</font>\");if(rpc.dueMsg){getTag(\"dueDay\").innerText=rpc.dueMsg;getTag(\"dueMsgBox\").className=\"due-msg-box\"}else{getTag(\"dueDay\").innerText=amc.fn.i18nPlaceholderReplace(\"{{pcredit_text_full}}\",dueDay)}var b=amc.fn.i18nValueForKey(\"{{click_agree}}\")||\"\";var a=rpc.protocolsTitle||amc.fn.i18nValueForKey(\"{{open_pcredit_protocol}}\")||\"\";getTag(\"protocolInfo\").innerText=b;getTag(\"protocolName\").innerText=a;spmExposure(\"a283.b5789.c12705.d23269\");getTag(\"btnText\").style.maxWidth=window.innerWidth-70;if(b.length>12||a.length>60){getTag(\"protocolBox\").className=\"protocol-box-vert\"}if(isAndroidFingerPayHuawei&&!isUnderScreenFinger()){getTag(\"androidFingerPng\").src=androidFingerPng;hide(\"container\");show(\"androidFinger\");fingerPayHuawei();document.onreload=function(d){fingerPayHuawei()}}else{spmExposure(\"a283.b5789.c12705.d23267\")}}document.viewDidAppear=function(){if(isResume){amc.fn.spmExposureResume()}else{isResume=true}};function isUnderScreenFinger(){var b=-1;if(amc.isAndroid){var c=document.getCustomAttr(\"fpInfo\");try{var f=JSON.parse(c);if(f&&f.type!==undefined){b=f.type}}catch(d){amc.fn.logError(\"fpInfo\",c+\"\")}}var a=(b!==-1);if(a){amc.fn.logCount(\"fp\",\"us\")}return a}function gotoPwdArea(){var a={};a.action={name:\"loc:bnvb\"};a.param={};var b=rpc.bypass||{};a.param[\"data\"]=amc.fn.isObject(b.pwd)?b.pwd:{};a.param[\"data\"][\"spasswordPay\"]=rpc.spasswordPay;if(isAndroidFingerPayHuawei||wearablePay){}else{a.param[\"data\"][\"payOrder\"]=true}a.param[\"data\"][\"nextAction\"]=payAction;a.param[\"data\"][\"pwdTip\"]=rpc.pwdTip;a.param[\"data\"][\"logon_id\"]=rpc.logon_id;a.param[\"tplid\"]=\"QUICKPAY@open-pwd-check-flex\";a.param[\"tpl\"]=rpc.tpl;document.submit(a)}function onPaySuccess(){paySuccess=true;amc.fn.playGif(getTag(\"gifImg\"),amc.res.success);getTag(\"btnText\").innerText=\"{{pay_ok}}\"}function onPayFailure(){paySuccess=false;amc.fn.playGif(getTag(\"gifImg\"),\"\");getTag(\"btnText\").innerText=confirmPayText}function npwdPay(){var a={action:{name:payAction,loadtxt:\"\"}};a.action[\"neec\"]=\"6004\";amc.fn.playGif(getTag(\"gifImg\"),amc.res.loading);document.asyncSubmit(a,function(b){if(paySuccess){return}if(b.status==\"0001\"){onPaySuccess()}else{if(b.status==\"0000\"){onPayFailure()}else{if(b.status==\"0002\"){onPayFailure()}else{if(b.status==\"0006\"){onPayFailure()}}}}})}function alert(){var b=b||\"{{confirm_exit}}\";var a={title:\"\",message:b,okButton:\"{{confirm_btn}}\",cancelButton:\"{{input_pwd_s}}\"};document.confirm(a,function(c){if(c.ok){amc.fn.exit()}else{gotoPwdArea()}})}function onPay(){spmClicked(\"a283.b5789.c12705.d23267\");if(paySuccess){return}if(rpc.npwdPay){npwdPay();return}if(fingerPay||wearablePay){var a={action:{name:rpc.authAction,loadtxt:\"\"}};hide(\"gifImg\");if(fingerPay){if(amc.supportAuthType==\"faceid\"){getTag(\"btnText\").innerText=\"{{faceid_process}}\"}else{getTag(\"btnText\").innerText=\"{{finger_process}}\"}}else{getTag(\"btnText\").innerText=wearablePayText||\"\"}amc.fn.playGif(getTag(\"gifImg\"),amc.res.loading);document.asyncSubmit(a,function(c){var b=c.status&&c.status.substr(-2);if(c&&c.tip){rpc.pwdTip=c.tip}if(paySuccess){return}if(b===\"01\"){onPaySuccess()}else{if(b==\"03\"){amc.fn.playGif(getTag(\"gifImg\"),amc.res.loading);getTag(\"btnText\").innerText=\"{{paying}}\"}else{if(b===\"09\"){onPayFailure();if(fpCancelAction===\"1\"){gotoPwdArea()}else{if(fpCancelAction===\"2\"){alert()}else{amc.fn.exit()}}}else{if(b===\"00\"){onPayFailure()}else{if(b===\"04\"||b===\"05\"){onPayFailure();gotoPwdArea()}}}}}});return}gotoPwdArea()}function fingerPayHuawei(){var a={action:{name:rpc.authAction}};document.asyncSubmit(a,function(b){if(b.status==\"0001\"){getTag(\"fingerFextLeft\").innerText=\"{{pay_success}}\";hide(\"fingerTextRight\")}else{if(b.status==\"0002\"){getTag(\"fingerFextLeft\").innerText=\"{{auth_fingering}}\";hide(\"fingerTextRight\")}else{if(b.status==\"0003\"){getTag(\"fingerFextLeft\").innerText=\"{{paying}}\";hide(\"fingerTextRight\")}else{if(b.status==\"0004\"){gotoPwdArea()}else{if(b.status==\"0005\"){getTag(\"fingerFextLeft\").innerText=\"{{retry_finger}}\";hide(\"fingerTextRight\")}}}}}})}function openProtocol(){spmClicked(\"a283.b5789.c12705.d23269\");if(rpc.protocols){amc.fn.showProtocolList(rpc.protocols)}else{amc.fn.openweb(\"https://fun.alipay.com/bank/index.htm?page=HBFWXY\")}}function onBack(){spmClicked(\"a283.b5789.c12705.d23268\");amc.fn.spmPageDestroy(\"a283.b5789\");if(rpc.backAct==\"back\"){document.submit({action:{name:\"loc:back\"}})}else{document.submit({action:{name:\"/cashier/view\"}})}}function onKeyDown(){if(event.which==4){onBack()}};","tag":"text"}]},{"tag":"style","children":[{"text":".pay-text{color:#fff;}\n.hide-box{display:none;}\n\n.protocol-box-horiz {\n    display: flex;\n    align-items: flex-start;\n}\n.protocol-box-vert {\n    display: flex;\n    flex-direction: column;\n    overflow: scroll;\n    max-height: 100px;\n}\n.amc-i-nav-m-box {\n    flex: 4.0;\n    align-items: center;\n    justify-content: center;\n}\n.due-msg-box {\n     margin-top: 16px;\n}","tag":"text"}]}]},{"id":"body","onload":"init()","tag":"body","children":[{"id":"titleLine","tag":"div","css":"amc-1px-title-line"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"div","css":"amc-flex-space-1"},{"tag":"div","children":[{"id":"pcreditPayLogo","tag":"img"}],"css":"amc-pd-t"},{"tag":"div","css":"amc-abs-space-v-l"},{"tag":"div","children":[{"id":"creditAmount","tag":"label","css":"amc-text-center amc-ellipsis-3-line amc-flex-1 amc-font-l"}],"css":"amc-self-stretch"},{"id":"dueMsgBox","tag":"div","children":[{"id":"dueDay","tag":"label","css":"amc-text-center amc-flex-1 amc-ellipsis-3-line amc-margin-t-xs amc-font-l amc-text-light-color"}],"css":"amc-self-stretch"},{"tag":"div","css":"amc-flex-space-2"}],"css":"amc-pd-lr amc-v-box amc-align-center amc-scroll-flex"},{"tag":"div","children":[{"id":"protocolBox","tag":"div","children":[{"id":"protocolInfo","tag":"label","css":"amc-font-m amc-margin-r-xs  amc-ellipsis"},{"id":"protocolName","tag":"label","onclick":"openProtocol()","css":"amc-font-m amc-theme-color amc-flex-1"}],"css":"protocol-box-horiz"},{"id":"container","tag":"div","children":[{"id":"payBtn","tag":"div","children":[{"id":"gifImg","tag":"embed","type":"MQPPayGifView","css":"amc-btn-img amc-hidden"},{"id":"btnText","tag":"label","css":"pay-text amc-font-super-l amc-btn-ellpsis"}],"onclick":"onPay()","css":"amc-btn-primary amc-justify-center amc-align-center"}],"css":"amc-pd-t"},{},{"id":"androidFinger","tag":"div","children":[{"tag":"div","children":[{"id":"androidFingerPng","tag":"img","css":"preditpay-finger-img-android"}],"css":"amc-justify-center amc-margin-b"},{"tag":"div","children":[{"id":"fingerFextLeft","tag":"label","children":[{"text":"{{agree_auth_fp}}","tag":"text"}],"css":"amc-font-s amc-text-slight-color amc-margin-r-xs"},{"id":"fingerTextRight","tag":"label","children":[{"text":"{{input_pwd_s}}","tag":"text"}],"onclick":"gotoPwdArea()","css":"amc-font-s amc-theme-color"}],"css":"amc-justify-center"}],"css":"amc-v-box hide-box"},{"tag":"div","css":"amc-iphone-x-pd-b"}],"css":"amc-pd-lr amc-v-box amc-b-box amc-pd-t-s"}],"css":"amc-v-box amc-flex-1"}],"onkeydown":"onKeyDown()","css":"amc-i-body"}]},"format":"JSON","tplVersion":"5.3.1"}