{"time":"0009","tplId":"QUICKPAY@cashier-card-no-flex","publishVersion":"150924","tag":"QUICKPAY","name":"cashier-card-no-flex","data":{"tag":"html","children":[{"tag":"head","children":[{"tag":"meta","src":"AlipaySDK.bundle/amc.i18n","type":"i18n"},{"tag":"link","rel":"stylesheet","href":"AlipaySDK.bundle/amc.css"},{"tag":"script","src":"AlipaySDK.bundle/amc.js"},{"tag":"script","children":[{"text":"amc.fn.spmPageCreate(\"a283.b4032\");var getTag=amc.fn.getById;var rpc=amc.rpcData;var show=amc.fn.show;var hide=amc.fn.hide;var scanFlag=false;var cameraImg=amc.path+\"alipay_msp_icon_camera\";var lastNoValue=\"\";var MIN_CARD_NO_LENGTH=12;var fixedCardNo=rpc.cardNo&&rpc.cardNo.split(\" \").join(\"\");fixedCardNo=(parseInt2Str(fixedCardNo)||\"\");if(fixedCardNo.length<MIN_CARD_NO_LENGTH){fixedCardNo=null}function parseInt2Str(f){var a=\"\";try{f=f+\"\";for(var c=0;c<f.length;c++){var b=parseInt(f[c]);if(isNaN(b)){return\"\"}a+=b}}catch(d){return\"\"}return a}function init(){try{initUI();if(amc.fn.logPageInit){amc.fn.logPageInit(true)}}catch(a){if(amc.fn.logPageInit){amc.fn.logPageInit()}}}function initUI(){var e=null;var d=null;if(rpc.bizIdentifier==\"isolated\"){e=amc.path+\"alipay_msp_help\";d=onHelp;amc.fn.spmExposure(\"a283.b4032.c9686.d24461\")}if(rpc.switchAcc){e=amc.res.navMore;d=onChangeAccount}var b={};if(rpc.backAct===\"back\"){b.backMode=\"back\"}var f=amc.fn.navBack(true,rpc.title||\"{{add_card}}\",null,e,onBack,d,b);getTag(\"body\").insertBefore(f,getTag(\"mainBody\"));amc.fn.spmExposure(\"a283.b4032.c9686.d17361\");if(rpc.newCardTip){getTag(\"newCardTip\").innerText=rpc.newCardTip}else{hide(\"newCardTipBox\")}if(getTag(\"navImgR\")!==undefined){getTag(\"navImgR\").alt=\"{{help}}\"}if(amc.isAndroid){getTag(\"loading\").src=amc.path+\"alipay_msp_indicator_white_loading\"}getTag(\"camera\").src=cameraImg;if(rpc.gonggao){var c=amc.fn.create(\"div\");c.className=\"amc-marquee amc-pd-lr\";var a=amc.fn.create(\"marquee\");a.className=\"amc-marquee\";a.innerText=rpc.gonggao||\"\";c.appendChild(a);a.style.width=window.innerWidth-(amc.isPlus?40:30);getTag(\"body\").insertBefore(c,getTag(\"mainBody\"))}if(rpc.userName){getTag(\"cardOwnerInfo\").src=amc.path+\"alipay_msp_info\";getTag(\"cardOwner\").innerText=rpc.userName;show(\"cardOwnerArea\")}if(rpc.cardNoTip){getTag(\"cardNo\").setAttribute(\"placeholder\",rpc.cardNoTip)}if(fixedCardNo){getTag(\"cardNo\").value=maskCardNo(fixedCardNo);formatBankNo();getTag(\"cardNo\").disabled=true}else{getTag(\"cardNo\").focus();updateState(\"\")}amc.fn.spmExposure(\"a283.b4032.c9686.d17362\");if(rpc.asi==\"ACTIVE\"){show(\"asiBox\");getTag(\"asiImg\").src=amc.path+\"alipay_msp_asi_icon\"}}function maskCardNo(c){var a=\"\";if(!c||!amc.fn.isString(c)){return a}for(var b=0;b<c.length;b++){if(b<c.length-4){a+=\"*\"}else{a+=c[b]}}return a}function updateState(d){var b=getTag(\"camera\");var c=getTag(\"submit\");var a=d.replace(/\\s/g,\"\");if(a.length>=MIN_CARD_NO_LENGTH){c.disabled=false;getTag(\"btnText\").style.color=\"#fff\"}else{c.disabled=true;getTag(\"btnText\").style.color=\"#d2d2d2\"}if(a.length){hide(\"cameraBox\")}else{if(!rpc.disable){show(\"cameraBox\")}}}function formatBankNo(){var a=getTag(\"cardNo\");var b=a.value||\"\";if(b){a.value=(b.replace(/([\\d|\\*]{4})(?=[\\d|\\*])/g,\"$1 \")).trim()||\"\"}updateState(b)}function checkInput(){var b=getTag(\"cardNo\").value||\"\";var a=b.replace(/\\s/g,\"\");var c=\"^\\\\d{0,19}$\";if(a.match(c)){lastNoValue=b}else{getTag(\"cardNo\").value=lastNoValue;return}formatBankNo();scanFlag=false}function onBack(){amc.fn.spmClick(\"a283.b4032.c9686.d17361\");amc.fn.spmPageDestroy(\"a283.b4032\");if(rpc.backAct===\"back\"){amc.fn.back()}else{if(rpc.backAct){var a={action:{name:rpc.backAct}};a.param={};a.param[\"first_enter_cashier\"]=false;document.submit(a)}else{amc.fn.exitConfirm()}}}function onKeyDown(){if(event.which==4){onBack()}}function onSubmit(){amc.fn.spmClick(\"a283.b4032.c9686.d17362\");var a={};a.action={name:rpc.nextAction||\"/card/verifyCardNo\",loadtxt:\"\",host:rpc.pci_url,https:true,enctype:\"application/x-www-form-urlencoded\",request_param:\"requestData\",params:rpc.params};a.param={cardno:fixedCardNo||getTag(\"cardNo\").value.split(\" \").join(\"\")};if(scanFlag){a.param[\"scanflag\"]=true}document.asyncSubmit(a,function(c){if(c.pageloading===\"1\"){hide(\"btnText\");show(\"loading\")}else{if(c.pageloading===\"0\"){show(\"btnText\");hide(\"loading\")}else{if(c.status){var b=c.status.substr(2,2);if(b===\"02\"){getTag(\"cardNo\").focus()}}}}});hide(\"btnText\");show(\"loading\")}function onScanCard(){document.asyncSubmit({action:{name:\"loc:scancard\"}},function(a){if(a.data){getTag(\"cardNo\").value=a.data;formatBankNo();scanFlag=true}})}function onHelp(){var a=rpc.helpURL||\"https://csmobile.alipay.com/router.htm?scene=app_addcard\";document.submit({action:{name:\"loc:openweb('\"+a+\"', '{{help}}')\"}});amc.fn.spmClick(\"a283.b4032.c9686.d24461\")}function dial(){var a=\"loc:tel('95188', '1')\";var b={action:{name:a}};document.submit(b);getTag(\"securityInfoDlg\").close()}function onChangeAccount(){if(rpc.switchAcc){var a=new Array();a.push(\"{{switch_account}}\");document.actionSheet({btns:a,cancelBtn:\"{{cancel}}\"},function(b){if(b.index===0){var c={action:{name:\"/cashier/switchAccount\"}};c.param={backAct:\"exit\"};document.submit(c)}})}};","tag":"text"}]},{"tag":"style","children":[{"text":".guide-circle {\n        background-color: #ccc;\n        border-radius: 4px;\n        height: 8px;\n        width: 8px;\n    }\n\n    .guide-line2px {\n        background-color: #ccc;\n        height: 2px;\n        flex: 5.0;\n    }\n\n    .guide-blank-area {\n        flex: 2.0;\n    }\n\n    .guide-upper-box {\n        justify-content: center;\n    }\n\n    .guide-lower-box {\n        justify-content: center;\n        align-items: center;\n    }\n\n    .loading-color {\n        color: #fff;\n    }\n\n    .camera-box {\n        align-items: center;\n    }\n\n    .card-no-cell {\n        background-color: #fff;\n        align-items: center;\n        padding-top: 5px;\n        padding-bottom: 5px;\n    }\n\n    .ellipsis-3-line {\n        -webkit-line-clamp: 3;\n        -webkit-box-orient: vertical;\n        display: -webkit-box;\n    }\n\n    .dlg-title-box {\n        margin-top: 21px;\n        margin-bottom: 6px;\n        padding: 0 15px;\n    }\n\n    .dlg-title {\n        font-size: 18px;\n        font-weight: bold;\n        text-align: center;\n        flex: 1;\n    }\n\n    .dlg-dot {\n        margin-top: 7px;\n        width: 4px;\n        height: 4px;\n        background-color: #777;\n        border-radius: 2px;\n    }\n\n    .dlg-list {\n        font-size: 15px;\n        margin-left: 6px;\n    }\n\n    .tip-box {\n        padding: 9px 15px 0 15px;\n    }\n\n    .pd-lr {\n        padding-left: 15px;\n        padding-right: 15px;\n    }\n\n    .dlg-btn-text {\n        font-size: 17px;\n        color: #108ee9;\n        text-align: center;\n        margin: 11.5px 15px;\n    }\n\n    .dlg-line {\n        margin-top: 18px;\n    }\n\n    .amc-dlg-width {\n        width: 270px;\n        max-width: 270px;\n        min-width: 270px;\n    }\n\n    .amc-dlg-box {\n        border: 0;\n        background-color: #fff;\n        border-radius: 8px;\n        width: 270px;\n        align-items: center;\n    }\n\n    .text-light-color {\n        color: #777;\n    }\n\n    .font-l {\n        font-size: 16px;\n    }\n\n    .font-m {\n        font-size: 14px;\n    }\n\n    .font-super {\n        font-size: 20px;\n    }\n\n    .info-img {\n        height: 21px;\n        width: 21px;\n        max-height: 21px;\n        max-width: 21px;\n    }\n    .asi-img {\n        width: 12px;\n        height: 12px;\n        margin-right: 5px;\n    }\n    .asi-txt {\n        color: #576C97;\n        font-size: 12px;\n    }","tag":"text"}]}]},{"id":"body","onload":"init()","tag":"body","children":[{},{"id":"mainBody","tag":"div","children":[{},{"id":"newCardTipBox","tag":"div","children":[{"id":"newCardTip","tag":"label","css":"text-light-color font-m amc-flex-1 ellipsis-3-line"}],"css":"amc-align-center amc-pd-lr amc-margin-b-ss"},{"tag":"div","css":"amc-1px-line"},{},{"id":"cardOwnerArea","tag":"div","children":[{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{card_owner}}","tag":"text"}],"css":"ellipsis-3-line amc-flex-1 font-l"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"cardOwner","tag":"label","css":"ellipsis-3-line amc-flex-1 font-l"}],"css":"amc-cell-m-box amc-input-box-height"},{"tag":"div","children":[{"id":"cardOwnerInfo","alt":"{{card_owner_info_title}}","tag":"img","css":"info-img"}],"onclick":"getTag('cardOwnerInfodlg').showModal();"}],"css":"card-no-cell amc-pd-lr"},{"tag":"div","css":"amc-1px-line amc-margin-lr"}],"css":"amc-v-box amc-hidden"},{},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{card_no}}","tag":"text"}],"css":"ellipsis-3-line amc-flex-1 font-l"}],"css":"amc-cell-l-box"},{"tag":"div","children":[{"id":"cardNo","autofocus":"true","placeholder":"{{new_card_placeholder}}","tag":"input","value":"","type":"number","css":"amc-input font-l","oninput":"checkInput();"}],"css":"amc-cell-m-box amc-input-box-height"},{"id":"cameraBox","tag":"div","children":[{"id":"camera","tag":"img"}],"onclick":"onScanCard();","css":"camera-box amc-hidden"}],"css":"card-no-cell amc-pd-lr"},{"tag":"div","css":"amc-1px-line"},{},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{alipay_sec}}","tag":"text"}],"css":"text-light-color amc-flex-1 font-m ellipsis-3-line"}],"onclick":"getTag('securityInfoDlg').showModal();","css":"amc-cell-footer-box"},{"tag":"div","children":[{"id":"submit","tag":"div","children":[{"id":"loading","tag":"img","src":"indicatior","css":"amc-loading-img loading-color amc-hidden"},{"id":"btnText","tag":"label","children":[{"text":"{{next}}","tag":"text"}],"css":"amc-btn-disabled-color font-super amc-btn-disabled-color amc-text-center amc-flex-1 amc-ellipsis"}],"onclick":"onSubmit();","disabled":"true","css":"amc-btn-primary amc-justify-center amc-align-center"}],"css":"amc-pd-lr amc-pd-b"},{"id":"asiBox","tag":"div","children":[{"id":"asiImg","tag":"img","css":"asi-img"},{"tag":"label","children":[{"text":"{{asi_open}}","tag":"text"}],"css":"asi-txt"}],"css":"amc-flex-center amc-hidden"}],"css":"amc-main amc-scroll-android"},{},{"id":"cardOwnerInfodlg","tag":"dialog","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{card_owner_info_title}}","tag":"text"}],"css":"dlg-title"}],"css":"dlg-title-box"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{card_owner_info}}","tag":"text"}],"css":"dlg-list amc-flex-1"}],"css":"tip-box"},{"tag":"div","css":"amc-adapt-line dlg-line"},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{cashier_no_dlg_btn}}","tag":"text"}],"css":"dlg-btn-text amc-flex-1 amc-ellipsis"}],"onclick":"getTag('cardOwnerInfodlg').close();","css":"amc-align-center amc-justify-center"}],"css":"amc-v-box amc-dlg-width"}],"css":"amc-dlg-box amc-v-box"},{},{"id":"securityInfoDlg","tag":"dialog","children":[{"tag":"div","children":[{"tag":"label","children":[{"text":"{{cashier_no_dlg_title}}","tag":"text"}],"css":"dlg-title"}],"css":"dlg-title-box"},{"tag":"div","children":[{"tag":"div","children":[{"tag":"div","css":"dlg-dot"},{"tag":"label","children":[{"text":"{{cashier_no_tip_1}}","tag":"text"}],"css":"dlg-list amc-flex-1"}],"css":"tip-box"},{"tag":"div","children":[{"tag":"div","css":"dlg-dot"},{"tag":"label","children":[{"text":"{{cashier_no_tip_3}}","tag":"text"}],"css":"dlg-list amc-flex-1"}],"css":"tip-box"},{"tag":"div","children":[{"tag":"div","css":"dlg-dot"},{"tag":"label","children":[{"text":"{{cashier_no_tip_4}}","tag":"text"}],"css":"dlg-list amc-flex-1"}],"css":"tip-box"},{"tag":"div","children":[{"tag":"div","css":"dlg-dot"},{"tag":"label","children":[{"text":"{{cashier_no_tip_5}}","tag":"text"}],"onclick":"dial();","css":"dlg-list amc-flex-1"}],"css":"tip-box"},{"tag":"div","css":"amc-adapt-line dlg-line"},{"tag":"div","children":[{"tag":"label","children":[{"text":"{{cashier_no_dlg_btn}}","tag":"text"}],"css":"dlg-btn-text amc-flex-1 amc-ellipsis"}],"onclick":"getTag('securityInfoDlg').close();","css":"amc-align-center amc-justify-center"}],"css":"amc-v-box amc-dlg-width"}],"css":"amc-dlg-box amc-v-box"}],"onkeydown":"onKeyDown();","css":"amc-body"}]},"format":"JSON","tplVersion":"5.2.9"}